<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: SIFixSGPRLiveRanges.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.6 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4d9c1978b5f07b6adb33a8870a898946.html">llvm3.6</a></li><li class="navelem"><a class="el" href="dir_5fa7ecd8d95c317b32615506984470d8.html">lib</a></li><li class="navelem"><a class="el" href="dir_e05b01359e968234de0369341286fe1b.html">Target</a></li><li class="navelem"><a class="el" href="dir_425160c7594ba0b571d934f7a8c32ff5.html">R600</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">SIFixSGPRLiveRanges.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="AMDGPU_8h_source.html">AMDGPU.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SIInstrInfo_8h_source.html">SIInstrInfo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SIRegisterInfo_8h_source.html">SIRegisterInfo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="LiveIntervalAnalysis_8h_source.html">llvm/CodeGen/LiveIntervalAnalysis.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="MachineFunctionPass_8h_source.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="MachineInstrBuilder_8h_source.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="MachinePostDominators_8h_source.html">llvm/CodeGen/MachinePostDominators.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="MachineRegisterInfo_8h_source.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Debug_8h_source.html">llvm/Support/Debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Target_2TargetMachine_8h_source.html">llvm/Target/TargetMachine.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for SIFixSGPRLiveRanges.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="SIFixSGPRLiveRanges_8cpp__incl.png" border="0" usemap="#SIFixSGPRLiveRanges_8cpp" alt=""/></div>
<map name="SIFixSGPRLiveRanges_8cpp" id="SIFixSGPRLiveRanges_8cpp">
<area shape="rect" id="node2" href="AMDGPU_8h.html" title="AMDGPU.h" alt="" coords="581,177,673,203"/><area shape="rect" id="node12" href="Target_2TargetMachine_8h.html" title="llvm/Target/TargetMachine.h" alt="" coords="527,266,726,293"/><area shape="rect" id="node15" href="SIInstrInfo_8h.html" title="Interface definition for SIInstrInfo. " alt="" coords="1717,87,1814,114"/><area shape="rect" id="node34" href="SIRegisterInfo_8h.html" title="Interface definition for SIRegisterInfo. " alt="" coords="1667,177,1787,203"/><area shape="rect" id="node35" href="Debug_8h.html" title="llvm/Support/Debug.h" alt="" coords="973,266,1134,293"/><area shape="rect" id="node37" href="LiveIntervalAnalysis_8h.html" title="llvm/CodeGen/LiveInterval\lAnalysis.h" alt="" coords="2889,80,3076,121"/><area shape="rect" id="node43" href="MachineFunctionPass_8h.html" title="llvm/CodeGen/MachineFunction\lPass.h" alt="" coords="3120,348,3341,389"/><area shape="rect" id="node46" href="MachineInstrBuilder_8h.html" title="llvm/CodeGen/MachineInstr\lBuilder.h" alt="" coords="1413,259,1609,300"/><area shape="rect" id="node47" href="MachinePostDominators_8h.html" title="llvm/CodeGen/MachinePost\lDominators.h" alt="" coords="3359,169,3555,211"/><area shape="rect" id="node49" href="MachineRegisterInfo_8h.html" title="llvm/CodeGen/MachineRegister\lInfo.h" alt="" coords="1215,169,1433,211"/><area shape="rect" id="node3" href="TargetRegistry_8h.html" title="llvm/Support/TargetRegistry.h" alt="" coords="275,266,482,293"/><area shape="rect" id="node4" href="include_2llvm-c_2Disassembler_8h.html" title="llvm&#45;c/Disassembler.h" alt="" coords="5,355,168,382"/><area shape="rect" id="node5" href="Triple_8h.html" title="llvm/ADT/Triple.h" alt="" coords="193,355,319,382"/><area shape="rect" id="node6" href="CodeGen_8h.html" title="llvm/Support/CodeGen.h" alt="" coords="829,355,1008,382"/><area shape="rect" id="node7" href="ErrorHandling_8h.html" title="llvm/Support/ErrorHandling.h" alt="" coords="993,445,1199,471"/><area shape="rect" id="node8" href="StringRef_8h.html" title="llvm/ADT/StringRef.h" alt="" coords="879,527,1030,553"/><area shape="rect" id="node11" href="Compiler_8h.html" title="llvm/Support/Compiler.h" alt="" coords="1234,676,1409,703"/><area shape="rect" id="node13" href="Pass_8h.html" title="llvm/Pass.h" alt="" coords="1275,527,1368,553"/><area shape="rect" id="node14" href="TargetOptions_8h.html" title="llvm/Target/TargetOptions.h" alt="" coords="395,527,589,553"/><area shape="rect" id="node16" href="AMDGPUInstrInfo_8h.html" title="Contains the definition of a TargetInstrInfo class that is common to all AMD GPUs. " alt="" coords="2137,177,2279,203"/><area shape="rect" id="node32" href="SIDefines_8h.html" title="SIDefines.h" alt="" coords="1887,177,1982,203"/><area shape="rect" id="node17" href="AMDGPURegisterInfo_8h.html" title="TargetRegisterInfo interface that is implemented by all hw codegen targets. " alt="" coords="1685,266,1851,293"/><area shape="rect" id="node23" href="TargetInstrInfo_8h.html" title="llvm/Target/TargetInstrInfo.h" alt="" coords="2497,266,2695,293"/><area shape="rect" id="node18" href="BitVector_8h.html" title="llvm/ADT/BitVector.h" alt="" coords="1185,355,1335,382"/><area shape="rect" id="node19" href="TargetRegisterInfo_8h.html" title="llvm/Target/TargetRegister\lInfo.h" alt="" coords="2105,348,2290,389"/><area shape="rect" id="node20" href="MachineBasicBlock_8h.html" title="llvm/CodeGen/MachineBasic\lBlock.h" alt="" coords="2331,437,2533,479"/><area shape="rect" id="node24" href="MachineFunction_8h.html" title="llvm/CodeGen/MachineFunction.h" alt="" coords="2410,355,2643,382"/><area shape="rect" id="node25" href="Allocator_8h.html" title="llvm/Support/Allocator.h" alt="" coords="2695,445,2870,471"/><area shape="rect" id="node26" href="SmallVector_8h.html" title="llvm/ADT/SmallVector.h" alt="" coords="2773,527,2944,553"/><area shape="rect" id="node28" href="AlignOf_8h.html" title="llvm/Support/AlignOf.h" alt="" coords="2897,601,3060,628"/><area shape="rect" id="node27" href="iterator__range_8h.html" title="llvm/ADT/iterator_range.h" alt="" coords="2114,601,2299,628"/><area shape="rect" id="node33" href="MCInstrDesc_8h.html" title="llvm/MC/MCInstrDesc.h" alt="" coords="1927,266,2095,293"/><area shape="rect" id="node36" href="raw__ostream_8h.html" title="llvm/Support/raw_ostream.h" alt="" coords="715,445,917,471"/><area shape="rect" id="node38" href="IndexedMap_8h.html" title="llvm/ADT/IndexedMap.h" alt="" coords="1461,355,1632,382"/><area shape="rect" id="node41" href="LiveInterval_8h.html" title="llvm/CodeGen/LiveInterval.h" alt="" coords="2659,177,2858,203"/><area shape="rect" id="node42" href="SlotIndexes_8h.html" title="llvm/CodeGen/SlotIndexes.h" alt="" coords="2821,266,3022,293"/><area shape="rect" id="node39" href="STLExtras_8h.html" title="llvm/ADT/STLExtras.h" alt="" coords="1675,445,1832,471"/><area shape="rect" id="node44" href="MachineInstrBundle_8h.html" title="llvm/CodeGen/MachineInstr\lBundle.h" alt="" coords="1657,348,1853,389"/><area shape="rect" id="node48" href="MachineDominators_8h.html" title="llvm/CodeGen/MachineDominators.h" alt="" coords="3098,266,3353,293"/><area shape="rect" id="node50" href="TargetSubtargetInfo_8h.html" title="llvm/Target/TargetSubtarget\lInfo.h" alt="" coords="750,259,949,300"/></map>
</div>
</div>
<p><a href="SIFixSGPRLiveRanges_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad78e062f62e0d6e453941fb4ca843e4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SIFixSGPRLiveRanges_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>&#160;&#160;&#160;&quot;si-fix-sgpr-live-ranges&quot;</td></tr>
<tr class="separator:ad78e062f62e0d6e453941fb4ca843e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac37d86cf760a6760bcac901440fc554c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SIFixSGPRLiveRanges_8cpp.html#ac37d86cf760a6760bcac901440fc554c">INITIALIZE_PASS_BEGIN</a> (SIFixSGPRLiveRanges, <a class="el" href="SIShrinkInstructions_8cpp.html#a030569d5a541b6110f2ae1b6a3413a58">DEBUG_TYPE</a>,&quot;SI Fix SGPR Live <a class="el" href="SIFixSGPRLiveRanges_8cpp.html#a5bd0b30cf15cb8f045b3609589e4222f">Ranges</a>&quot;, false, <a class="el" href="SimplifyInstructions_8cpp.html#a6dd713bd88673625bb181528a61bdc85">false</a>) <a class="el" href="JumpInstrTables_8cpp.html#afdca0f03e5390cb037c356a5e4ab4363">INITIALIZE_PASS_END</a>(SIFixSGPRLiveRanges</td></tr>
<tr class="separator:ac37d86cf760a6760bcac901440fc554c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a030569d5a541b6110f2ae1b6a3413a58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SIFixSGPRLiveRanges_8cpp.html#a030569d5a541b6110f2ae1b6a3413a58">DEBUG_TYPE</a></td></tr>
<tr class="separator:a030569d5a541b6110f2ae1b6a3413a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bd0b30cf15cb8f045b3609589e4222f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="AMDGPUInstrInfo_8cpp.html#a716f5e42d0d8cc3686f761545c8c20bca6cbe5ff42f143903e1c67abf94613791">SI</a> Fix SGPR Live&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SIFixSGPRLiveRanges_8cpp.html#a5bd0b30cf15cb8f045b3609589e4222f">Ranges</a></td></tr>
<tr class="separator:a5bd0b30cf15cb8f045b3609589e4222f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8cb04352df9ab526fe7de9a93373ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="AMDGPUInstrInfo_8cpp.html#a716f5e42d0d8cc3686f761545c8c20bca6cbe5ff42f143903e1c67abf94613791">SI</a> Fix SGPR Live&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SIFixSGPRLiveRanges_8cpp.html#a9f8cb04352df9ab526fe7de9a93373ec">false</a></td></tr>
<tr class="separator:a9f8cb04352df9ab526fe7de9a93373ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SALU instructions ignore control flow, so we need to modify the live ranges of the registers they define in some cases.</p>
<p>The main case we need to handle is when a def is used in one side of a branch and not another. For example:</p>
<p>def IF ... ... ELSE use ... ENDIF</p>
<p>Here we need the register allocator to avoid assigning any of the defs inside of the IF to the same register as def. In traditional live interval analysis def is not live inside the IF branch, however, since SALU instructions inside of IF will be executed even if the branch is not taken, there is the chance that one of the instructions will overwrite the value of def, so the use in ELSE will see the wrong value.</p>
<p>The strategy we use for solving this is to add an extra use after the ENDIF:</p>
<p>def IF ... ... ELSE use ... ENDIF use</p>
<p>Adding this use will make the def live thoughout the IF branch, which is what we want. </p>

<p>Definition in file <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html">SIFixSGPRLiveRanges.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad78e062f62e0d6e453941fb4ca843e4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_TYPE&#160;&#160;&#160;&quot;si-fix-sgpr-live-ranges&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html#l00061">61</a> of file <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html">SIFixSGPRLiveRanges.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac37d86cf760a6760bcac901440fc554c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INITIALIZE_PASS_BEGIN </td>
          <td>(</td>
          <td class="paramtype">SIFixSGPRLiveRanges&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="SIShrinkInstructions_8cpp.html#a030569d5a541b6110f2ae1b6a3413a58">DEBUG_TYPE</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;SI Fix SGPR Live <a class="el" href="SIFixSGPRLiveRanges_8cpp.html#a5bd0b30cf15cb8f045b3609589e4222f">Ranges</a>&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="SimplifyInstructions_8cpp.html#a6dd713bd88673625bb181528a61bdc85">false</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="SimplifyInstructions_8cpp.html#a6dd713bd88673625bb181528a61bdc85">false</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a030569d5a541b6110f2ae1b6a3413a58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEBUG_TYPE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html#l00094">94</a> of file <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html">SIFixSGPRLiveRanges.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9f8cb04352df9ab526fe7de9a93373ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="AMDGPUInstrInfo_8cpp.html#a716f5e42d0d8cc3686f761545c8c20bca6cbe5ff42f143903e1c67abf94613791">SI</a> Fix SGPR Live false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html#l00094">94</a> of file <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html">SIFixSGPRLiveRanges.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5bd0b30cf15cb8f045b3609589e4222f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="AMDGPUInstrInfo_8cpp.html#a716f5e42d0d8cc3686f761545c8c20bca6cbe5ff42f143903e1c67abf94613791">SI</a> Fix SGPR Live Ranges</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html#l00094">94</a> of file <a class="el" href="SIFixSGPRLiveRanges_8cpp_source.html">SIFixSGPRLiveRanges.cpp</a>.</p>

<p>Referenced by <a class="el" href="SelectionDAG_8cpp_source.html#l01919">llvm::SelectionDAG::computeKnownBits()</a>, <a class="el" href="FastISel_8cpp_source.html#l02104">llvm::FastISel::createMachineMemOperandFor()</a>, <a class="el" href="DbgValueHistoryCalculator_8cpp_source.html#l00050">llvm::DbgValueHistoryMap::endInstrRange()</a>, <a class="el" href="SelectionDAG_8cpp_source.html#l04640">llvm::SelectionDAG::getLoad()</a>, <a class="el" href="DbgValueHistoryCalculator_8cpp_source.html#l00061">llvm::DbgValueHistoryMap::getRegisterForVar()</a>, <a class="el" href="ValueTracking_8cpp_source.html#l01531">isKnownNonZero()</a>, <a class="el" href="DwarfDebug_8cpp_source.html#l00316">llvm::DwarfDebug::isLexicalScopeDIENull()</a>, <a class="el" href="YAMLParser_8cpp_source.html#l01530">llvm::yaml::Stream::printError()</a>, <a class="el" href="YAMLParser_8cpp_source.html#l00271">llvm::yaml::Scanner::printError()</a>, and <a class="el" href="DbgValueHistoryCalculator_8cpp_source.html#l00035">llvm::DbgValueHistoryMap::startInstrRange()</a>.</p>

</div>
</div>
</div><!-- contents -->
<hr>
<p class="footer">
Generated on Tue Dec 8 2015 00:59:54 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.6</a><br>
Copyright &copy; 2003-2014 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
