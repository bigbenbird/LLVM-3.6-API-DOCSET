<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: StatepointLowering.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.6 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4d9c1978b5f07b6adb33a8870a898946.html">llvm3.6</a></li><li class="navelem"><a class="el" href="dir_5fa7ecd8d95c317b32615506984470d8.html">lib</a></li><li class="navelem"><a class="el" href="dir_9d1c68ef0dc704dcdd9f5558cbff727e.html">CodeGen</a></li><li class="navelem"><a class="el" href="dir_20add21a41e34edf42cde49229be54ad.html">SelectionDAG</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">StatepointLowering.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="StatepointLowering_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- StatepointLowering.cpp - SDAGBuilder&#39;s statepoint code -----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This file includes support code use by SelectionDAGBuilder when lowering a</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// statepoint sequence in SelectionDAG IR.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StatepointLowering_8h.html">StatepointLowering.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SelectionDAGBuilder_8h.html">SelectionDAGBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FunctionLoweringInfo_8h.html">llvm/CodeGen/FunctionLoweringInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GCStrategy_8h.html">llvm/CodeGen/GCStrategy.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SelectionDAG_8h.html">llvm/CodeGen/SelectionDAG.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StackMaps_8h.html">llvm/CodeGen/StackMaps.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallingConv_8h.html">llvm/IR/CallingConv.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statepoint_8h.html">llvm/IR/Statepoint.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLowering_8h.html">llvm/Target/TargetLowering.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using namespace </span>llvm;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   32</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;statepoint-lowering&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="StatepointLowering_8cpp.html#a7b778f039f3221dad52383e3ed095842">STATISTIC</a>(NumSlotsAllocatedForStatepoints,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          <span class="stringliteral">&quot;Number of stack slots allocated for statepoints&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="StatepointLowering_8cpp.html#a7b778f039f3221dad52383e3ed095842">STATISTIC</a>(NumOfStatepoints, <span class="stringliteral">&quot;Number of statepoint nodes encountered&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<a class="code" href="StatepointLowering_8cpp.html#a7b778f039f3221dad52383e3ed095842">STATISTIC</a>(StatepointMaxSlotsRequired,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;          <span class="stringliteral">&quot;Maximum number of stack slots required for a singe statepoint&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classllvm_1_1StatepointLoweringState.html#aeb4b5a7ad5a49f17f8a34890eb6efefe">   41</a></span>&#160;<a class="code" href="classllvm_1_1StatepointLoweringState.html#aeb4b5a7ad5a49f17f8a34890eb6efefe">StatepointLoweringState::startNewStatepoint</a>(<a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// Consistency check</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(PendingGCRelocateCalls.empty() &amp;&amp;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         <span class="stringliteral">&quot;Trying to visit statepoint before finished processing previous one&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  Locations.clear();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  RelocLocations.clear();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  NextSlotToAllocate = 0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// Need to resize this on each safepoint - we need the two to stay in</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// sync and the clear patterns of a SelectionDAGBuilder have no relation</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// to FunctionLoweringInfo.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorImpl.html#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); i++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    AllocatedStackSlots[i] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classllvm_1_1StatepointLoweringState.html#a2651c31aeb22030422cc4e9ef6c21e22">   56</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1StatepointLoweringState.html#a2651c31aeb22030422cc4e9ef6c21e22">StatepointLoweringState::clear</a>() {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  Locations.clear();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  RelocLocations.clear();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(PendingGCRelocateCalls.empty() &amp;&amp;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <span class="stringliteral">&quot;cleared before statepoint sequence completed&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<a class="code" href="classllvm_1_1SDValue.html">SDValue</a></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classllvm_1_1StatepointLoweringState.html#a4841be2489ba10321338a1874b53f249">   65</a></span>&#160;<a class="code" href="classllvm_1_1StatepointLoweringState.html#a4841be2489ba10321338a1874b53f249">StatepointLoweringState::allocateStackSlot</a>(<a class="code" href="structllvm_1_1EVT.html">EVT</a> <a class="code" href="classllvm_1_1PointerUnion.html">ValueType</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                           <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  NumSlotsAllocatedForStatepoints++;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// The basic scheme here is to first look for a previously created stack slot</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// which is not in use (accounting for the fact arbitrary slots may already</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// be reserved), or to create a new stack slot and use it.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// If this doesn&#39;t succeed in 40000 iterations, something is seriously wrong</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 40000; i++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() ==</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;               AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &amp;&amp;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;           <span class="stringliteral">&quot;broken invariant&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> NumSlots = AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(NextSlotToAllocate &lt;= NumSlots &amp;&amp; <span class="stringliteral">&quot;broken invariant&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (NextSlotToAllocate &gt;= NumSlots) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(NextSlotToAllocate == NumSlots);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">// record stats</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (NumSlots + 1 &gt; StatepointMaxSlotsRequired) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        StatepointMaxSlotsRequired = NumSlots + 1;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SpillSlot = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a3de9644ea2dd81453acf760bd2c1f921">CreateStackTemporary</a>(ValueType);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> FI = cast&lt;FrameIndexSDNode&gt;(SpillSlot)-&gt;getIndex();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(FI);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      AllocatedStackSlots.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">return</span> SpillSlot;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (!AllocatedStackSlots[NextSlotToAllocate]) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> FI = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>[NextSlotToAllocate];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      AllocatedStackSlots[NextSlotToAllocate] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">return</span> Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#acb59cbd8f4a8c1cf820b2b540aebdac1">getFrameIndex</a>(FI, ValueType);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Note: We deliberately choose to advance this only on the failing path.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Doing so on the suceeding path involes a bit of complexity that caused a</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// minor bug previously.  Unless performance shows this matters, please</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// keep this code as simple as possible.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    NextSlotToAllocate++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;infinite loop?&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/// Try to find existing copies of the incoming values in stack slots used for</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">/// statepoint spilling.  If we can find a spill slot for the incoming value,</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">/// mark that slot as allocated, and reuse the same slot for this safepoint.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">/// This helps to avoid series of loads and stores that only serve to resuffle</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/// values on the stack between calls.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a5ddcf3be404162dbd3613b0aa1a39f56">  114</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="StatepointLowering_8cpp.html#a5ddcf3be404162dbd3613b0aa1a39f56">reservePreviousStackSlotForValue</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                             <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(Incoming) || isa&lt;FrameIndexSDNode&gt;(Incoming)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// We won&#39;t need to spill this, so no need to check for previously</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// allocated stack slots</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Loc = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a878ea78eaf07a94c8376112b094d2d6a">getLocation</a>(Incoming);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (Loc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// duplicates in input</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// Search back for the load from a stack slot pattern to find the original</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// slot we allocated for this value.  We could extend this to deal with</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// simple modification patterns, but simple dealing with trivial load/store</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// sequences helps a lot already.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadSDNode.html">LoadSDNode</a> *<a class="code" href="namespacellvm_1_1SPII.html#a0e840f41bc0e8233dd26cbff2591a584a5069619ca8fdce305534f3fe85091a0f">Load</a> = dyn_cast&lt;LoadSDNode&gt;(Incoming)) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *FI = dyn_cast&lt;FrameIndexSDNode&gt;(<a class="code" href="namespacellvm_1_1SPII.html#a0e840f41bc0e8233dd26cbff2591a584a5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getBasePtr())) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> Index = FI-&gt;getIndex();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">auto</span> Itr = std::find(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                           Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), Index);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">if</span> (Itr == Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>()) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">// not one of the lowering stack slots, can&#39;t reuse!</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// TODO: Actually, we probably could reuse the stack slot if the value</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// hasn&#39;t changed at all, but we&#39;d need to look for intervening writes</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// This is one of our dedicated lowering slots</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> Offset =</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            std::distance(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">FuncInfo</a>.<a class="code" href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">StatepointStackSlots</a>.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), Itr);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">if</span> (Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a6cdb26e5268cc05eb7f9726a140f1ae2">isStackSlotAllocated</a>(Offset)) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="comment">// stack slot already assigned to someone else, can&#39;t use it!</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="comment">// TODO: currently we reserve space for gc arguments after doing</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <span class="comment">// normal allocation for deopt arguments.  We should reserve for</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="comment">// _all_ deopt and gc arguments, then start allocating.  This</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="comment">// will prevent some moves being inserted when vm state changes,</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="comment">// but gc state doesn&#39;t between two calls.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// Reserve this stack slot</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#af93bbb466651e3e6abdf9e35c0a34b30">reserveStackSlot</a>(Offset);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// Cache this slot so we find it when going through the normal</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">// assignment loop.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Loc =</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a6ececde40ed933c2dfb5af16cb002529">getTargetFrameIndex</a>(Index, Incoming.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a61b235461056cb2459ac87b660426c90">setLocation</a>(Incoming, Loc);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// TODO: handle case where a reloaded value flows through a phi to</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// another safepoint.  e.g.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// bb1:</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">//  a&#39; = relocated...</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// bb2: % pred: bb1, bb3, bb4, etc.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//  a_phi = phi(a&#39;, ...)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// statepoint ... a_phi</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// NOTE: This will require reasoning about cross basic block values.  This is</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// decidedly non trivial and this might not be the right place to do it.  We</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// don&#39;t really have the information we need here...</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// TODO: handle simple updates.  If a value is modified and the original</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// value is no longer live, it would be nice to put the modified value in the</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// same slot.  This allows folding of the memory accesses for some</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// instructions types (like an increment).</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// statepoint (i)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// i1 = i+1</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// statepoint (i1)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">/// Remove any duplicate (as SDValues) from the derived pointer pairs.  This</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/// is not required for correctness.  It&#39;s purpose is to reduce the size of</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/// StackMap section.  It has no effect on the number of spill slots required</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/// or the actual lowering.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a78099da4c0cc5e8d8323326e91a03cf4">  193</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="StatepointLowering_8cpp.html#a78099da4c0cc5e8d8323326e91a03cf4">removeDuplicatesGCPtrs</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Bases,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Ptrs,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Relocs,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                   <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// This is horribly ineffecient, but I don&#39;t care right now</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;SDValue, 64&gt;</a> Seen;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const Value *, 64&gt;</a> NewBases, NewPtrs, NewRelocs;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>(); i++) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SD = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(Ptrs[i]);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// Only add non-duplicates</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (Seen.<a class="code" href="classllvm_1_1SmallSet.html#a75238c8d967e3014bc35c24c843c230f">count</a>(SD) == 0) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      NewBases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Bases[i]);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      NewPtrs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Ptrs[i]);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      NewRelocs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Relocs[i]);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Seen.<a class="code" href="classllvm_1_1SmallSet.html#a892daa20eb21173ba89e9fe9702e7f6c">insert</a>(SD);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Bases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &gt;= NewBases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &gt;= NewPtrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Relocs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &gt;= NewRelocs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  Bases = NewBases;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  Ptrs = NewPtrs;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  Relocs = NewRelocs;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == Bases.size());</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == Relocs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">/// Extract call from statepoint, lower it and return pointer to the</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// call node. Also update NodeMap so that getValue(statepoint) will</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/// reference lowered call result</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#accd30daeca42d24fa84d08bf702ba4fc">  225</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *<a class="code" href="StatepointLowering_8cpp.html#accd30daeca42d24fa84d08bf702ba4fc">lowerCallFromStatepoint</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                       <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(<a class="code" href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a48a8d9481765073621e8eb71b3f7c88f">Intrinsic::experimental_gc_statepoint</a> ==</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;             dyn_cast&lt;IntrinsicInst&gt;(&amp;CI)-&gt;<a class="code" href="AArch64ISelLowering_8cpp.html#a62766c75f88612ffa652342472e755f6">getIntrinsicID</a>() &amp;&amp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;         <span class="stringliteral">&quot;function called must be the statepoint function&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classllvm_1_1ImmutableStatepoint.html">ImmutableStatepoint</a> StatepointOperands(&amp;CI);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// Lower the actual call itself - This is a bit of a hack, but we want to</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// avoid modifying the actual lowering code.  This is similiar in intent to</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// the LowerCallOperands mechanism used by PATCHPOINT, but is structured</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// differently.  Hopefully, this is slightly more robust w.r.t. calling</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// convention, return values, and other function attributes.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ActualCallee = <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1Value.html">Value</a> *<span class="keyword">&gt;</span>(StatepointOperands.<a class="code" href="classllvm_1_1StatepointBase.html#a60a86561cf9ba84b564e3e7ffbb143cb">actualCallee</a>());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  std::vector&lt;Value *&gt; Args;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="classllvm_1_1User.html#ab829c5fd1bbf60f869608ba1143be151">CallInst::const_op_iterator</a> arg_begin = StatepointOperands.<a class="code" href="classllvm_1_1StatepointBase.html#a96da9f75b12494111cf92a63247aa790">call_args_begin</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="classllvm_1_1User.html#ab829c5fd1bbf60f869608ba1143be151">CallInst::const_op_iterator</a> arg_end = StatepointOperands.<a class="code" href="classllvm_1_1StatepointBase.html#ab1ed184227d1e1614f567c88ab194397">call_args_end</a>();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  Args.insert(Args.end(), arg_begin, arg_end);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// TODO: remove the creation of a new instruction!  We should not be</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// modifying the IR (even temporarily) at this point.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Tmp = <a class="code" href="classllvm_1_1CallInst.html#a3ff9b8134737690083410aeeea42308e">CallInst::Create</a>(ActualCallee, Args);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  Tmp-&gt;<a class="code" href="classllvm_1_1CallInst.html#ad54481e3c992b555aeaba34a83daf7e6">setTailCall</a>(CI.<a class="code" href="classllvm_1_1CallInst.html#a5e07dea70b41ad610edbfc21bd54154a">isTailCall</a>());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  Tmp-&gt;<a class="code" href="classllvm_1_1CallInst.html#acd74b2224788f8d010e47622bb3c2a04">setCallingConv</a>(CI.<a class="code" href="classllvm_1_1CallInst.html#a2a65eaf09953a013c2820f6857c647f0">getCallingConv</a>());</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  Tmp-&gt;<a class="code" href="classllvm_1_1CallInst.html#a179ef4c643fb35a8dc364e4ae63950f9">setAttributes</a>(CI.<a class="code" href="classllvm_1_1CallInst.html#a39fed9e3fb9323a7eb73cb65409f5586">getAttributes</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#abf7344c24b84a77026aeba3707040282">LowerCallTo</a>(Tmp, Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(ActualCallee), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Handle the return value of the call iff any.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> HasDef = !Tmp-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">isVoidTy</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (HasDef) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// The value of the statepoint itself will be the value of call itself.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// We&#39;ll replace the actually call node shortly.  gc_result will grab</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// this value.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">setValue</a>(&amp;CI, Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(Tmp));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// The token value is never used from here on, just generate a poison value</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">setValue</a>(&amp;CI, Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">getIntPtrConstant</a>(-1));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// Remove the fake entry we created so we don&#39;t have a hanging reference</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// after we delete this node.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a53e10dee847a7e977d2cef2431e1094d">removeValue</a>(Tmp);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">delete</span> Tmp;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  Tmp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// Search for the call node</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// The following code is essentially reverse engineering X86&#39;s</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// LowerCallTo.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CallNode = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// We just emitted a call, so it should be last thing generated</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a2afe36f1344e00c9ef5f8cdb39d21890">getRoot</a>();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// Find closest CALLSEQ_END walking back through lowered nodes if needed</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CallEnd = Chain.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordtype">int</span> Sanity = 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">while</span> (CallEnd-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6feb9a82882ea426db5b62f3f69f63a2">ISD::CALLSEQ_END</a>) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    CallEnd = CallEnd-&gt;<a class="code" href="classllvm_1_1SDNode.html#ad2b86f3b725cc7b42da4e87e41bcf86f">getGluedNode</a>();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(CallEnd &amp;&amp; <span class="stringliteral">&quot;Can not find call node&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Sanity &lt; 20 &amp;&amp; <span class="stringliteral">&quot;should have found call end already&quot;</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    Sanity++;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(CallEnd-&gt;<a class="code" href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">getOpcode</a>() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6feb9a82882ea426db5b62f3f69f63a2">ISD::CALLSEQ_END</a> &amp;&amp;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="stringliteral">&quot;Expected a callseq node.&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(CallEnd-&gt;<a class="code" href="classllvm_1_1SDNode.html#ad2b86f3b725cc7b42da4e87e41bcf86f">getGluedNode</a>());</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// Step back inside the CALLSEQ</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  CallNode = CallEnd-&gt;<a class="code" href="classllvm_1_1SDNode.html#ad2b86f3b725cc7b42da4e87e41bcf86f">getGluedNode</a>();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span> CallNode;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">/// Callect all gc pointers coming into statepoint intrinsic, clean them up,</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">/// and return two arrays:</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">///   Bases - base pointers incoming to this statepoint</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">///   Ptrs - derived pointers incoming to this statepoint</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">///   Relocs - the gc_relocate corresponding to each base/ptr pair</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">/// Elements of this arrays should be in one-to-one correspondence with each</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/// other i.e Bases[i], Ptrs[i] are from the same gcrelocate call</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a7efabd1a79a863251e1dcc692ead3a5b">  304</a></span>&#160;<a class="code" href="StatepointLowering_8cpp.html#a7efabd1a79a863251e1dcc692ead3a5b">getIncomingStatepointGCValues</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Bases,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                              <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Ptrs,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                              <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;const Value *&gt;</a> &amp;Relocs,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                              <a class="code" href="classllvm_1_1ImmutableCallSite.html">ImmutableCallSite</a> <a class="code" href="classllvm_1_1Statepoint.html">Statepoint</a>,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                              <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// Search for relocated pointers.  Note that working backwards from the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// gc_relocates ensures that we only get pairs which are actually relocated</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// and used after the statepoint.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// TODO: This logic should probably become a utility function in Statepoint.h</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1User.html">User</a> *U : cast&lt;CallInst&gt;(Statepoint.<a class="code" href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">getInstruction</a>())-&gt;<a class="code" href="IVUsers_8cpp.html#ac2f338c3f467b3d09613e190d73044a5">users</a>()) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#af22b43ff66ea85772a51f169e1458431">isGCRelocate</a>(U)) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classllvm_1_1GCRelocateOperands.html">GCRelocateOperands</a> relocateOpers(U);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    Relocs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(cast&lt;Value&gt;(U));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    Bases.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(relocateOpers.<a class="code" href="classllvm_1_1GCRelocateOperands.html#a92998e4f3f83347477cd3d072daa0a86">basePtr</a>());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(relocateOpers.<a class="code" href="classllvm_1_1GCRelocateOperands.html#a026ba096a24e3e753d8faeee17bb5a99">derivedPtr</a>());</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// Remove any redundant llvm::Values which map to the same SDValue as another</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// input.  Also has the effect of removing duplicates in the original</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// llvm::Value input list as well.  This is a useful optimization for</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// reducing the size of the StackMap section.  It has no other impact.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="StatepointLowering_8cpp.html#a78099da4c0cc5e8d8323326e91a03cf4">removeDuplicatesGCPtrs</a>(Bases, Ptrs, Relocs, Builder);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Bases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() &amp;&amp; Ptrs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() == Relocs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>());</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/// Spill a value incoming to the statepoint. It might be either part of</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/// vmstate</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/// or gcstate. In both cases unconditionally spill it on the stack unless it</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/// is a null constant. Return pair with first element being frame index</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/// containing saved value and second element with outgoing chain from the</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// emitted store</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::pair&lt;SDValue, SDValue&gt;</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a9ab095a80bdcdd7bd24a024212d74f78">  339</a></span>&#160;<a class="code" href="StatepointLowering_8cpp.html#a9ab095a80bdcdd7bd24a024212d74f78">spillIncomingStatepointValue</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming, <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                             <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Loc = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a878ea78eaf07a94c8376112b094d2d6a">getLocation</a>(Incoming);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Emit new store if we didn&#39;t do it for this ptr before</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span> (!Loc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    Loc = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a4841be2489ba10321338a1874b53f249">allocateStackSlot</a>(Incoming.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(),</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                       Builder);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(isa&lt;FrameIndexSDNode&gt;(Loc));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> Index = cast&lt;FrameIndexSDNode&gt;(Loc)-&gt;getIndex();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// We use TargetFrameIndex so that isel will not select it into LEA</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    Loc = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a6ececde40ed933c2dfb5af16cb002529">getTargetFrameIndex</a>(Index, Incoming.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// TODO: We can create TokenFactor node instead of</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//       chaining stores one after another, this may allow</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//       a bit more optimal scheduling for them</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    Chain = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a6cf91c82ac05052e7df4671d0f4243cd">getStore</a>(Chain, Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a5dfe0b79aa455d1f0665bec48042f102">getCurSDLoc</a>(), Incoming, Loc,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                 <a class="code" href="structllvm_1_1MachinePointerInfo.html#acb492206d94d8f8179f797d4c7966ba9">MachinePointerInfo::getFixedStack</a>(Index),</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                 <span class="keyword">false</span>, <span class="keyword">false</span>, 0);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a61b235461056cb2459ac87b660426c90">setLocation</a>(Incoming, Loc);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Loc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">return</span> std::make_pair(Loc, Chain);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;}</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/// Lower a single value incoming to a statepoint node.  This value can be</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/// either a deopt value or a gc value, the handling is the same.  We special</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/// case constants and allocas, then fall back to spilling if required.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a13b083808f22acb86f68d1909ef131fc">  369</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="StatepointLowering_8cpp.html#a13b083808f22acb86f68d1909ef131fc">lowerIncomingStatepointValue</a>(<a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                         <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDValue&gt;</a> &amp;Ops,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                         <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#aa3e946c1fc678a70e849244389bd929a">getRoot</a>();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantSDNode.html">ConstantSDNode</a> *<a class="code" href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">C</a> = dyn_cast&lt;ConstantSDNode&gt;(Incoming)) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// If the original value was a constant, make sure it gets recorded as</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// such in the stackmap.  This is required so that the consumer can</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// parse any internal format to the deopt state.  It also handles null</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// pointers and other constant pointers in GC states</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(<a class="code" href="classllvm_1_1StackMaps.html#a181f65d4a4da75240c4f105cf644fa1dad60dbfe71ff0c05604ef33b8e82f2529">StackMaps::ConstantOp</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getSExtValue(), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1FrameIndexSDNode.html">FrameIndexSDNode</a> *FI = dyn_cast&lt;FrameIndexSDNode&gt;(Incoming)) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// This handles allocas as arguments to the statepoint</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLowering.html">TargetLowering</a> &amp;TLI = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">getTargetLoweringInfo</a>();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a6ececde40ed933c2dfb5af16cb002529">getTargetFrameIndex</a>(FI-&gt;getIndex(), TLI.<a class="code" href="classllvm_1_1TargetLoweringBase.html#a2824c264a25f2f03586588c7020b7a5d">getPointerTy</a>()));</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// Otherwise, locate a spill slot and explicitly spill it so it</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// can be found by the runtime later.  We currently do not support</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// tracking values through callee saved registers to their eventual</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// spill location.  This would be a useful optimization, but would</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// need to be optional since it requires a lot of complexity on the</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// runtime side which not all would support.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    std::pair&lt;SDValue, SDValue&gt; Res =</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="StatepointLowering_8cpp.html#a9ab095a80bdcdd7bd24a024212d74f78">spillIncomingStatepointValue</a>(Incoming, Chain, Builder);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Res.first);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    Chain = Res.second;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">setRoot</a>(Chain);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/// Lower deopt state and gc pointer arguments of the statepoint.  The actual</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/// lowering is described in lowerIncomingStatepointValue.  This function is</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// responsible for lowering everything in the right position and playing some</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// tricks to avoid redundant stack manipulation where possible.  On</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">/// completion, &#39;Ops&#39; will contain ready to use operands for machine code</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">/// statepoint. The chain nodes will have already been created and the DAG root</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">/// will be set to the last value spilled (if any were).</span></div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="StatepointLowering_8cpp.html#a0cd760d0d9a1cb4a0ed5542b1a21f300">  410</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="StatepointLowering_8cpp.html#a0cd760d0d9a1cb4a0ed5542b1a21f300">lowerStatepointMetaArgs</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;SDValue&gt;</a> &amp;Ops,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                    <a class="code" href="classllvm_1_1ImmutableStatepoint.html">ImmutableStatepoint</a> <a class="code" href="classllvm_1_1Statepoint.html">Statepoint</a>,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                    <a class="code" href="classllvm_1_1SelectionDAGBuilder.html">SelectionDAGBuilder</a> &amp;Builder) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// Lower the deopt and gc arguments for this statepoint.  Layout will</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// be: deopt argument length, deopt arguments.., gc arguments...</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const Value *, 64&gt;</a> Bases, Ptrs, Relocations;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="StatepointLowering_8cpp.html#a7efabd1a79a863251e1dcc692ead3a5b">getIncomingStatepointGCValues</a>(Bases, Ptrs, Relocations,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a8f6d0aa18d2e2916c6ffe525f91fd4b6">getCallSite</a>(), Builder);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Check that each of the gc pointer and bases we&#39;ve gotten out of the</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// safepoint is something the strategy thinks might be a pointer into the GC</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// heap.  This is basically just here to help catch errors during statepoint</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// insertion. TODO: This should actually be in the Verifier, but we can&#39;t get</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// to the GCStrategy from there (yet).</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">if</span> (Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a9b4db8b8082660004fda0c282da0ff0a">GFI</a>) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="classllvm_1_1GCStrategy.html">GCStrategy</a> &amp;S = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a9b4db8b8082660004fda0c282da0ff0a">GFI</a>-&gt;<a class="code" href="classllvm_1_1GCFunctionInfo.html#ab94a270eed698fd72d991d5dd8393e01">getStrategy</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V : Bases) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">auto</span> Opt = S.<a class="code" href="classllvm_1_1GCStrategy.html#a01d50a4fd2b2151f9788b0f64d98f43f">isGCManagedPointer</a>(V);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (Opt.hasValue()) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Opt.getValue() &amp;&amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;               <span class="stringliteral">&quot;non gc managed base pointer found in statepoint&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V : Ptrs) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keyword">auto</span> Opt = S.<a class="code" href="classllvm_1_1GCStrategy.html#a01d50a4fd2b2151f9788b0f64d98f43f">isGCManagedPointer</a>(V);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (Opt.hasValue()) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Opt.getValue() &amp;&amp;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;               <span class="stringliteral">&quot;non gc managed derived pointer found in statepoint&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V : Relocations) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keyword">auto</span> Opt = S.<a class="code" href="classllvm_1_1GCStrategy.html#a01d50a4fd2b2151f9788b0f64d98f43f">isGCManagedPointer</a>(V);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">if</span> (Opt.hasValue()) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Opt.getValue() &amp;&amp; <span class="stringliteral">&quot;non gc managed pointer relocated&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// Before we actually start lowering (and allocating spill slots for values),</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// reserve any stack slots which we judge to be profitable to reuse for a</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// particular value.  This is purely an optimization over the code below and</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// doesn&#39;t change semantics at all.  It is important for performance that we</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// reserve slots for both deopt and gc values before lowering either.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a8866a7048ecf4fc75b276afd28d33093">vm_state_begin</a>() + 1, E = Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a0f24677425320aac46780aab9c4d03c7">vm_state_end</a>();</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(V);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="StatepointLowering_8cpp.html#a5ddcf3be404162dbd3613b0aa1a39f56">reservePreviousStackSlotForValue</a>(Incoming, Builder);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Bases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() * 2; ++i) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// Even elements will contain base, odd elements - derived ptr</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V = i % 2 ? Bases[i / 2] : Ptrs[i / 2];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(V);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="StatepointLowering_8cpp.html#a5ddcf3be404162dbd3613b0aa1a39f56">reservePreviousStackSlotForValue</a>(Incoming, Builder);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// First, prefix the list with the number of unique values to be</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// lowered.  Note that this is the number of *Values* not the</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// number of SDValues required to lower them.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NumVMSArgs = Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a7d54132cd8265744890a923641e839ed">numTotalVMSArgs</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(<a class="code" href="classllvm_1_1StackMaps.html#a181f65d4a4da75240c4f105cf644fa1dad60dbfe71ff0c05604ef33b8e82f2529">StackMaps::ConstantOp</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(NumVMSArgs, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(NumVMSArgs + 1 == std::distance(Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a8866a7048ecf4fc75b276afd28d33093">vm_state_begin</a>(),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                         Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a0f24677425320aac46780aab9c4d03c7">vm_state_end</a>()));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// The vm state arguments are lowered in an opaque manner.  We do</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// not know what type of values are contained within.  We skip the</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// first one since that happens to be the total number we lowered</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// explicitly just above.  We could have left it in the loop and</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// not done it explicitly, but it&#39;s far easier to understand this</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// way.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a8866a7048ecf4fc75b276afd28d33093">vm_state_begin</a>() + 1, E = Statepoint.<a class="code" href="classllvm_1_1StatepointBase.html#a0f24677425320aac46780aab9c4d03c7">vm_state_end</a>();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(V);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="StatepointLowering_8cpp.html#a13b083808f22acb86f68d1909ef131fc">lowerIncomingStatepointValue</a>(Incoming, Ops, Builder);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Finally, go ahead and lower all the gc arguments.  There&#39;s no prefixed</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">// length for this one.  After lowering, we&#39;ll have the base and pointer</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// arrays interwoven with each (lowered) base pointer immediately followed by</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// it&#39;s (lowered) derived pointer.  i.e</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// (base[0], ptr[0], base[1], ptr[1], ...)</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Bases.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">size</a>() * 2; ++i) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// Even elements will contain base, odd elements - derived ptr</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V = i % 2 ? Bases[i / 2] : Ptrs[i / 2];</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Incoming = Builder.<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(V);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="StatepointLowering_8cpp.html#a13b083808f22acb86f68d1909ef131fc">lowerIncomingStatepointValue</a>(Incoming, Ops, Builder);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordtype">void</span> SelectionDAGBuilder::visitStatepoint(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// The basic scheme here is that information about both the original call and</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// the safepoint is encoded in the CallInst.  We create a temporary call and</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// lower it, then reverse engineer the calling sequence.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Check some preconditions for sanity</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(<a class="code" href="namespacellvm.html#a4d27484fb53770829a90be12d1827f7b">isStatepoint</a>(&amp;CI) &amp;&amp;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         <span class="stringliteral">&quot;function called must be the statepoint function&quot;</span>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  NumOfStatepoints++;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Clear state</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#aeb4b5a7ad5a49f17f8a34890eb6efefe">startNewStatepoint</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Consistency check</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1User.html">User</a> *U : CI.<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">Call</a> = cast&lt;CallInst&gt;(U);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#af22b43ff66ea85772a51f169e1458431">isGCRelocate</a>(Call))</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#aca8f1320bf0f665f1ec1843fce82384c">scheduleRelocCall</a>(*Call);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <a class="code" href="classllvm_1_1ImmutableStatepoint.html">ImmutableStatepoint</a> ISP(&amp;CI);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor"></span>  <span class="comment">// If this is a malformed statepoint, report it early to simplify debugging.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// This should catch any IR level mistake that&#39;s made when constructing or</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// transforming statepoints.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  ISP.verify();</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// Check that the associated GCStrategy expects to encounter statepoints.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// TODO: This if should become an assert.  For now, we allow the GCStrategy</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// to be optional for backwards compatibility.  This will only last a short</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// period (i.e. a couple of weeks).</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a9b4db8b8082660004fda0c282da0ff0a">GFI</a>) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a9b4db8b8082660004fda0c282da0ff0a">GFI</a>-&gt;<a class="code" href="classllvm_1_1GCFunctionInfo.html#ab94a270eed698fd72d991d5dd8393e01">getStrategy</a>().<a class="code" href="classllvm_1_1GCStrategy.html#ab0b748f9f0b95f18af234b4045ec700e">useStatepoints</a>() &amp;&amp;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;           <span class="stringliteral">&quot;GCStrategy does not expect to encounter statepoints&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// Lower statepoint vmstate and gcstate arguments</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 10&gt;</a> LoweredArgs;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="StatepointLowering_8cpp.html#a0cd760d0d9a1cb4a0ed5542b1a21f300">lowerStatepointMetaArgs</a>(LoweredArgs, ISP, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// Get call node, we will replace it later with statepoint</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *CallNode = <a class="code" href="StatepointLowering_8cpp.html#accd30daeca42d24fa84d08bf702ba4fc">lowerCallFromStatepoint</a>(CI, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Construct the actual STATEPOINT node with all the appropriate arguments</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// and return values.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// TODO: Currently, all of these operands are being marked as read/write in</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// PrologEpilougeInserter.cpp, we should special case the VMState arguments</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// and flags to be read-only.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SDValue, 40&gt;</a> Ops;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// Calculate and push starting position of vmstate arguments</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// Call Node: Chain, Target, {Args}, RegMask, [Glue]</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Glue;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#ad2b86f3b725cc7b42da4e87e41bcf86f">getGluedNode</a>()) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// Glue is always last operand</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    Glue = CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() - 1);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// Get number of arguments incoming directly into call node</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">unsigned</span> NumCallRegArgs =</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">getNumOperands</a>() - (Glue.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>() ? 4 : 3);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(NumCallRegArgs, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">MVT::i32</a>));</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// Add call target</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> CallTarget = <a class="code" href="classllvm_1_1SDValue.html">SDValue</a>(CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(1).<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>(), 0);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(CallTarget);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// Add call arguments</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// Get position of register mask in the call</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="classllvm_1_1SDUse.html">SDNode::op_iterator</a> RegMaskIt;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">if</span> (Glue.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    RegMaskIt = CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a992906781101abb22f6e4d16622bbe24">op_end</a>() - 2;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    RegMaskIt = CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a992906781101abb22f6e4d16622bbe24">op_end</a>() - 1;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a94d23373106467003722f7d6c17b1528">insert</a>(Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">op_begin</a>() + 2, RegMaskIt);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// Add a leading constant argument with the Flags and the calling convention</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// masked together</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="code" href="classunsigned.html">CallingConv::ID</a> CallConv = CI.<a class="code" href="classllvm_1_1CallInst.html#a2a65eaf09953a013c2820f6857c647f0">getCallingConv</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespaceSIInstrFlags.html#a607b4b0952924970b77a9c6b42898b54">Flags</a> = <a class="code" href="namespacellvm.html#a3ef25ef75dac918e4dc006b078c49b3e">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>&gt;(CI.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(2))-&gt;getZExtValue();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Flags == 0 &amp;&amp; <span class="stringliteral">&quot;not expected to be used&quot;</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(<a class="code" href="classllvm_1_1StackMaps.html#a181f65d4a4da75240c4f105cf644fa1dad60dbfe71ff0c05604ef33b8e82f2529">StackMaps::ConstantOp</a>, <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">getTargetConstant</a>(Flags | ((<span class="keywordtype">unsigned</span>)CallConv &lt;&lt; 1), <a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">MVT::i64</a>));</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// Insert all vmstate and gcstate arguments</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a94d23373106467003722f7d6c17b1528">insert</a>(Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>(), LoweredArgs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">begin</a>(), LoweredArgs.<a class="code" href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">end</a>());</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// Add register mask from call node</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(*RegMaskIt);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// Add chain</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(CallNode-&gt;<a class="code" href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">getOperand</a>(0));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// Same for the glue, but we add it only if original call had it</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> (Glue.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>())</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    Ops.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(Glue);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// Compute return values</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;EVT, 21&gt;</a> ValueVTs;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  ValueVTs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">MVT::Other</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  ValueVTs.<a class="code" href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">push_back</a>(<a class="code" href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">MVT::Glue</a>); <span class="comment">// provide a glue output since we consume one</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// as input.  This allows someone else to chain</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// off us as needed.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="structllvm_1_1SDVTList.html">SDVTList</a> NodeTys = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a196c23d6cb4d768d037970f1f35bbf66">getVTList</a>(ValueVTs);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <a class="code" href="classllvm_1_1SDNode.html">SDNode</a> *StatepointMCNode = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#afe8c553ab3418eec718860c098c6e080">getMachineNode</a>(<a class="code" href="namespacellvm_1_1TargetOpcode.html#a545ed70cd7fddb78f8a9200e31d7b5a4a9a5e04a47bc910a73cada89ff3aa66fa">TargetOpcode::STATEPOINT</a>,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                                <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a5dfe0b79aa455d1f0665bec48042f102">getCurSDLoc</a>(), NodeTys, Ops);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// Replace original call</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">ReplaceAllUsesWith</a>(CallNode, StatepointMCNode); <span class="comment">// This may update Root</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="comment">// Remove originall call node</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">DeleteNode</a>(CallNode);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// DON&#39;T set the root - under the assumption that it&#39;s already set past the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// inserted node we created.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// TODO: A better future implementation would be to emit a single variable</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// argument, variable return value STATEPOINT node here and then hookup the</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// return value of each gc.relocate to the respective output of the</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// previously emitted STATEPOINT value.  Unfortunately, this doesn&#39;t appear</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// to actually be possible today.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keywordtype">void</span> SelectionDAGBuilder::visitGCResult(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// The result value of the gc_result is simply the result of the actual</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// call.  We&#39;ve already emitted this, so just grab the value.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(CI.<a class="code" href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">getArgOperand</a>(0));</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(<a class="code" href="namespacellvm.html#a4d27484fb53770829a90be12d1827f7b">isStatepoint</a>(I) &amp;&amp;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;         <span class="stringliteral">&quot;first argument must be a statepoint token&quot;</span>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">setValue</a>(&amp;CI, <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(I));</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">void</span> SelectionDAGBuilder::visitGCRelocate(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Consistency check</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#ab72dadb5010ec0fd29e51b96d29345fb">relocCallVisited</a>(CI);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="classllvm_1_1GCRelocateOperands.html">GCRelocateOperands</a> relocateOpers(&amp;CI);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SD = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">getValue</a>(relocateOpers.derivedPtr());</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantSDNode&gt;(SD) || isa&lt;FrameIndexSDNode&gt;(SD)) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// We didn&#39;t need to spill these special cases (constants and allocas).</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// See the handling in spillIncomingValueForStatepoint for detail.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">setValue</a>(&amp;CI, SD);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Loc = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a31b3b6f388d85fe4cee1f0947e1500b3">getRelocLocation</a>(SD);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Emit new load if we did not emit it before</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (!Loc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>()) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> SpillSlot = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a878ea78eaf07a94c8376112b094d2d6a">getLocation</a>(SD);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">int</span> FI = cast&lt;FrameIndexSDNode&gt;(SpillSlot)-&gt;getIndex();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// Be conservative: flush all pending loads</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// TODO: Probably we can be less restrictive on this,</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// it may allow more scheduling opprtunities</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="classllvm_1_1SDValue.html">SDValue</a> Chain = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#aa3e946c1fc678a70e849244389bd929a">getRoot</a>();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    Loc = <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#abe25708ae246670b7cdaaccc77e0679a">getLoad</a>(SpillSlot.<a class="code" href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">getValueType</a>(), <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a5dfe0b79aa455d1f0665bec48042f102">getCurSDLoc</a>(), Chain,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                      SpillSlot, <a class="code" href="structllvm_1_1MachinePointerInfo.html#acb492206d94d8f8179f797d4c7966ba9">MachinePointerInfo::getFixedStack</a>(FI), <span class="keyword">false</span>,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                      <span class="keyword">false</span>, <span class="keyword">false</span>, 0);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">StatepointLowering</a>.<a class="code" href="classllvm_1_1StatepointLoweringState.html#a98b82d7facdd87692f80ce1868a1723a">setRelocLocation</a>(SD, Loc);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// Again, be conservative, don&#39;t emit pending loads</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">DAG</a>.<a class="code" href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">setRoot</a>(Loc.<a class="code" href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">getValue</a>(1));</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(Loc.<a class="code" href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">getNode</a>());</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <a class="code" href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">setValue</a>(&amp;CI, Loc);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a8866a7048ecf4fc75b276afd28d33093"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a8866a7048ecf4fc75b276afd28d33093">llvm::StatepointBase::vm_state_begin</a></div><div class="ttdeci">CallSiteTy::arg_iterator vm_state_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00098">Statepoint.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a075e34e98605d0e7c289763a104869ac"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a075e34e98605d0e7c289763a104869ac">llvm::SmallVectorTemplateCommon::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00113">SmallVector.h:113</a></div></div>
<div class="ttc" id="namespaceSIInstrFlags_html_a607b4b0952924970b77a9c6b42898b54"><div class="ttname"><a href="namespaceSIInstrFlags.html#a607b4b0952924970b77a9c6b42898b54">SIInstrFlags::Flags</a></div><div class="ttdeci">Flags</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00054">SIDefines.h:54</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a22a311dfe4c28a897de8a9365a4f0a84"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a22a311dfe4c28a897de8a9365a4f0a84">llvm::SmallVectorTemplateCommon::size</a></div><div class="ttdeci">size_type size() const </div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00126">SmallVector.h:126</a></div></div>
<div class="ttc" id="SmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateBase_html_ae1a10b90f22c0478960fb5798ff73916"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateBase.html#ae1a10b90f22c0478960fb5798ff73916">llvm::SmallVectorTemplateBase::push_back</a></div><div class="ttdeci">void push_back(const T &amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00221">SmallVector.h:221</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a040481b9bda32faa6b1435532405d88f"><div class="ttname"><a href="classllvm_1_1SDValue.html#a040481b9bda32faa6b1435532405d88f">llvm::SDValue::getValue</a></div><div class="ttdeci">SDValue getValue(unsigned R) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00152">SelectionDAGNodes.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a98b82d7facdd87692f80ce1868a1723a"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a98b82d7facdd87692f80ce1868a1723a">llvm::StatepointLoweringState::setRelocLocation</a></div><div class="ttdeci">void setRelocLocation(SDValue val, SDValue Location)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00073">StatepointLowering.h:73</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca59a1908cf136662bcfdc11ed49515ca9">llvm::MVT::Glue</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineValueType_8h_source.html#l00114">MachineValueType.h:114</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca97f56253625b3fe7b371ce76722de4b8">llvm::MVT::i64</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineValueType_8h_source.html#l00043">MachineValueType.h:43</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a8f6d0aa18d2e2916c6ffe525f91fd4b6"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a8f6d0aa18d2e2916c6ffe525f91fd4b6">llvm::StatepointBase::getCallSite</a></div><div class="ttdeci">CallSiteTy getCallSite()</div><div class="ttdoc">Return the underlying CallSite. </div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00063">Statepoint.h:63</a></div></div>
<div class="ttc" id="CallingConv_8h_html"><div class="ttname"><a href="CallingConv_8h.html">CallingConv.h</a></div></div>
<div class="ttc" id="IntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a0cd760d0d9a1cb4a0ed5542b1a21f300"><div class="ttname"><a href="StatepointLowering_8cpp.html#a0cd760d0d9a1cb4a0ed5542b1a21f300">lowerStatepointMetaArgs</a></div><div class="ttdeci">static void lowerStatepointMetaArgs(SmallVectorImpl&lt; SDValue &gt; &amp;Ops, ImmutableStatepoint Statepoint, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00410">StatepointLowering.cpp:410</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html">llvm::SelectionDAGBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00085">SelectionDAGBuilder.h:85</a></div></div>
<div class="ttc" id="classllvm_1_1ImmutableStatepoint_html"><div class="ttname"><a href="classllvm_1_1ImmutableStatepoint.html">llvm::ImmutableStatepoint</a></div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00152">Statepoint.h:152</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_ad2b86f3b725cc7b42da4e87e41bcf86f"><div class="ttname"><a href="classllvm_1_1SDNode.html#ad2b86f3b725cc7b42da4e87e41bcf86f">llvm::SDNode::getGluedNode</a></div><div class="ttdeci">SDNode * getGluedNode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00625">SelectionDAGNodes.h:625</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01241">Instructions.h:1241</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_af0d328f3f61168f4ea7d6e4044af4f97"><div class="ttname"><a href="classllvm_1_1SDNode.html#af0d328f3f61168f4ea7d6e4044af4f97">llvm::SDNode::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00407">SelectionDAGNodes.h:407</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_ad8368fe85feec440623e9558e100f357"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#ad8368fe85feec440623e9558e100f357">llvm::SelectionDAGBuilder::setValue</a></div><div class="ttdeci">void setValue(const Value *V, SDValue NewN)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00615">SelectionDAGBuilder.h:615</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_abe25708ae246670b7cdaaccc77e0679a"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#abe25708ae246670b7cdaaccc77e0679a">llvm::SelectionDAG::getLoad</a></div><div class="ttdeci">SDValue getLoad(EVT VT, SDLoc dl, SDValue Chain, SDValue Ptr, MachinePointerInfo PtrInfo, bool isVolatile, bool isNonTemporal, bool isInvariant, unsigned Alignment, const AAMDNodes &amp;AAInfo=AAMDNodes(), const MDNode *Ranges=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04721">SelectionDAG.cpp:4721</a></div></div>
<div class="ttc" id="FunctionLoweringInfo_8h_html"><div class="ttname"><a href="FunctionLoweringInfo_8h.html">FunctionLoweringInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_abc5c2f1d47a517373030133c6a102106"><div class="ttname"><a href="classllvm_1_1SDNode.html#abc5c2f1d47a517373030133c6a102106">llvm::SDNode::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00602">SelectionDAGNodes.h:602</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a836c27481205f56e708fe0c15538d5ff"><div class="ttname"><a href="classllvm_1_1SDNode.html#a836c27481205f56e708fe0c15538d5ff">llvm::SDNode::getOperand</a></div><div class="ttdeci">const SDValue &amp; getOperand(unsigned Num) const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00608">SelectionDAGNodes.h:608</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00035">User.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a3d2e079387a6e69ce2c8bb27bf7c2f32"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a3d2e079387a6e69ce2c8bb27bf7c2f32">llvm::SelectionDAG::setRoot</a></div><div class="ttdeci">const SDValue &amp; setRoot(SDValue N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00340">SelectionDAG.h:340</a></div></div>
<div class="ttc" id="Statistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a5f57dcbedc16dced31c61f7bbbb06ded"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a5f57dcbedc16dced31c61f7bbbb06ded">llvm::SelectionDAG::DeleteNode</a></div><div class="ttdeci">void DeleteNode(SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l00671">SelectionDAG.cpp:671</a></div></div>
<div class="ttc" id="structllvm_1_1MachinePointerInfo_html_acb492206d94d8f8179f797d4c7966ba9"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html#acb492206d94d8f8179f797d4c7966ba9">llvm::MachinePointerInfo::getFixedStack</a></div><div class="ttdeci">static MachinePointerInfo getFixedStack(int FI, int64_t offset=0)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00434">MachineInstr.cpp:434</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_a025adb087cac36e2cd504a33e8cb749d"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#a025adb087cac36e2cd504a33e8cb749d">llvm::SelectionDAGBuilder::getValue</a></div><div class="ttdeci">SDValue getValue(const Value *V)</div><div class="ttdoc">getValue - Return an SDValue for the given Value. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8cpp_source.html#l01020">SelectionDAGBuilder.cpp:1020</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_acd74b2224788f8d010e47622bb3c2a04"><div class="ttname"><a href="classllvm_1_1CallInst.html#acd74b2224788f8d010e47622bb3c2a04">llvm::CallInst::setCallingConv</a></div><div class="ttdeci">void setCallingConv(CallingConv::ID CC)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01359">Instructions.h:1359</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_aa3e946c1fc678a70e849244389bd929a"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#aa3e946c1fc678a70e849244389bd929a">llvm::SelectionDAGBuilder::getRoot</a></div><div class="ttdeci">SDValue getRoot()</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8cpp_source.html#l00909">SelectionDAGBuilder.cpp:909</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a6cf91c82ac05052e7df4671d0f4243cd"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a6cf91c82ac05052e7df4671d0f4243cd">llvm::SelectionDAG::getStore</a></div><div class="ttdeci">SDValue getStore(SDValue Chain, SDLoc dl, SDValue Val, SDValue Ptr, MachinePointerInfo PtrInfo, bool isVolatile, bool isNonTemporal, unsigned Alignment, const AAMDNodes &amp;AAInfo=AAMDNodes())</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l04775">SelectionDAG.cpp:4775</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a0f24677425320aac46780aab9c4d03c7"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a0f24677425320aac46780aab9c4d03c7">llvm::StatepointBase::vm_state_end</a></div><div class="ttdeci">CallSiteTy::arg_iterator vm_state_end()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00101">Statepoint.h:101</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a60a86561cf9ba84b564e3e7ffbb143cb"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a60a86561cf9ba84b564e3e7ffbb143cb">llvm::StatepointBase::actualCallee</a></div><div class="ttdeci">ValueTy * actualCallee()</div><div class="ttdoc">Return the value actually being called or invoked. </div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00068">Statepoint.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a3ff9b8134737690083410aeeea42308e"><div class="ttname"><a href="classllvm_1_1CallInst.html#a3ff9b8134737690083410aeeea42308e">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(Value *Func, ArrayRef&lt; Value * &gt; Args, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01263">Instructions.h:1263</a></div></div>
<div class="ttc" id="ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8h_source.html#l00098">ErrorHandling.h:98</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a96da9f75b12494111cf92a63247aa790"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a96da9f75b12494111cf92a63247aa790">llvm::StatepointBase::call_args_begin</a></div><div class="ttdeci">CallSiteTy::arg_iterator call_args_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00081">Statepoint.h:81</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_ab1ed184227d1e1614f567c88ab194397"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#ab1ed184227d1e1614f567c88ab194397">llvm::StatepointBase::call_args_end</a></div><div class="ttdeci">CallSiteTy::arg_iterator call_args_end()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00087">Statepoint.h:87</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00035">APInt.h:35</a></div></div>
<div class="ttc" id="classunsigned_html"><div class="ttname"><a href="classunsigned.html">unsigned</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a5ddcf3be404162dbd3613b0aa1a39f56"><div class="ttname"><a href="StatepointLowering_8cpp.html#a5ddcf3be404162dbd3613b0aa1a39f56">reservePreviousStackSlotForValue</a></div><div class="ttdeci">static void reservePreviousStackSlotForValue(SDValue Incoming, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00114">StatepointLowering.cpp:114</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a196c23d6cb4d768d037970f1f35bbf66"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a196c23d6cb4d768d037970f1f35bbf66">llvm::SelectionDAG::getVTList</a></div><div class="ttdeci">SDVTList getVTList(EVT VT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05175">SelectionDAG.cpp:5175</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLoweringBase_html_a2824c264a25f2f03586588c7020b7a5d"><div class="ttname"><a href="classllvm_1_1TargetLoweringBase.html#a2824c264a25f2f03586588c7020b7a5d">llvm::TargetLoweringBase::getPointerTy</a></div><div class="ttdeci">virtual MVT getPointerTy(uint32_t=0) const </div><div class="ttdef"><b>Definition:</b> <a href="TargetLoweringBase_8cpp_source.html#l00856">TargetLoweringBase.cpp:856</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00033">Instruction.h:33</a></div></div>
<div class="ttc" id="classllvm_1_1TargetLowering_html"><div class="ttname"><a href="classllvm_1_1TargetLowering.html">llvm::TargetLowering</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l02021">TargetLowering.h:2021</a></div></div>
<div class="ttc" id="structllvm_1_1SDVTList_html"><div class="ttname"><a href="structllvm_1_1SDVTList.html">llvm::SDVTList</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00078">SelectionDAGNodes.h:78</a></div></div>
<div class="ttc" id="namespacellvm_html_a4d27484fb53770829a90be12d1827f7b"><div class="ttname"><a href="namespacellvm.html#a4d27484fb53770829a90be12d1827f7b">llvm::isStatepoint</a></div><div class="ttdeci">bool isStatepoint(const ImmutableCallSite &amp;CS)</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8cpp_source.html#l00022">Statepoint.cpp:22</a></div></div>
<div class="ttc" id="namespacellvm_html_af22b43ff66ea85772a51f169e1458431"><div class="ttname"><a href="namespacellvm.html#af22b43ff66ea85772a51f169e1458431">llvm::isGCRelocate</a></div><div class="ttdeci">bool isGCRelocate(const Instruction *inst)</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8cpp_source.html#l00040">Statepoint.cpp:40</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_a53e10dee847a7e977d2cef2431e1094d"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#a53e10dee847a7e977d2cef2431e1094d">llvm::SelectionDAGBuilder::removeValue</a></div><div class="ttdeci">void removeValue(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00621">SelectionDAGBuilder.h:621</a></div></div>
<div class="ttc" id="namespacellvm_1_1SPII_html_a0e840f41bc0e8233dd26cbff2591a584a5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a0e840f41bc0e8233dd26cbff2591a584a5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00031">SparcInstrInfo.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1GCStrategy_html_ab0b748f9f0b95f18af234b4045ec700e"><div class="ttname"><a href="classllvm_1_1GCStrategy.html#ab0b748f9f0b95f18af234b4045ec700e">llvm::GCStrategy::useStatepoints</a></div><div class="ttdeci">bool useStatepoints() const </div><div class="ttdef"><b>Definition:</b> <a href="GCStrategy_8h_source.html#l00104">GCStrategy.h:104</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a6ececde40ed933c2dfb5af16cb002529"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a6ececde40ed933c2dfb5af16cb002529">llvm::SelectionDAG::getTargetFrameIndex</a></div><div class="ttdeci">SDValue getTargetFrameIndex(int FI, EVT VT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00467">SelectionDAG.h:467</a></div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca04cca8bc12888d0a7238f55a6c550ad0">llvm::MVT::i32</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineValueType_8h_source.html#l00042">MachineValueType.h:42</a></div></div>
<div class="ttc" id="namespacellvm_html_af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51"><div class="ttname"><a href="namespacellvm.html#af6d6a791770bad2303c4399986979e3eae411369b2f0d8f484fec62c3291b1b51">llvm::Call</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConvLower_8h_source.html#l00187">CallingConvLower.h:187</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointBase_html_a7d54132cd8265744890a923641e839ed"><div class="ttname"><a href="classllvm_1_1StatepointBase.html#a7d54132cd8265744890a923641e839ed">llvm::StatepointBase::numTotalVMSArgs</a></div><div class="ttdeci">int numTotalVMSArgs()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00077">Statepoint.h:77</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a3fad042e27ba626acf5366c845b352d3"><div class="ttname"><a href="classllvm_1_1SDValue.html#a3fad042e27ba626acf5366c845b352d3">llvm::SDValue::getNode</a></div><div class="ttdeci">SDNode * getNode() const </div><div class="ttdoc">get the SDNode which holds the desired result </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00132">SelectionDAGNodes.h:132</a></div></div>
<div class="ttc" id="GCStrategy_8h_html"><div class="ttname"><a href="GCStrategy_8h.html">GCStrategy.h</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a13b083808f22acb86f68d1909ef131fc"><div class="ttname"><a href="StatepointLowering_8cpp.html#a13b083808f22acb86f68d1909ef131fc">lowerIncomingStatepointValue</a></div><div class="ttdeci">static void lowerIncomingStatepointValue(SDValue Incoming, SmallVectorImpl&lt; SDValue &gt; &amp;Ops, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00369">StatepointLowering.cpp:369</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_af93bbb466651e3e6abdf9e35c0a34b30"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#af93bbb466651e3e6abdf9e35c0a34b30">llvm::StatepointLoweringState::reserveStackSlot</a></div><div class="ttdeci">void reserveStackSlot(int Offset)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00104">StatepointLowering.h:104</a></div></div>
<div class="ttc" id="StatepointLowering_8h_html"><div class="ttname"><a href="StatepointLowering_8h.html">StatepointLowering.h</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a7efabd1a79a863251e1dcc692ead3a5b"><div class="ttname"><a href="StatepointLowering_8cpp.html#a7efabd1a79a863251e1dcc692ead3a5b">getIncomingStatepointGCValues</a></div><div class="ttdeci">static void getIncomingStatepointGCValues(SmallVectorImpl&lt; const Value * &gt; &amp;Bases, SmallVectorImpl&lt; const Value * &gt; &amp;Ptrs, SmallVectorImpl&lt; const Value * &gt; &amp;Relocs, ImmutableCallSite Statepoint, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00304">StatepointLowering.cpp:304</a></div></div>
<div class="ttc" id="GlobalMerge_8cpp_html_a65c1240c404c646dd0e63fdcbf620730"><div class="ttname"><a href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a></div><div class="ttdeci">assert(Globals.size() &gt; 1)</div></div>
<div class="ttc" id="classllvm_1_1MVT_html_afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797"><div class="ttname"><a href="classllvm_1_1MVT.html#afd69b4f2dff97a2d7c0192cc769ef50ca62a222acce6360abd2726719fabc2797">llvm::MVT::Other</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineValueType_8h_source.html#l00038">MachineValueType.h:38</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantSDNode_html"><div class="ttname"><a href="classllvm_1_1ConstantSDNode.html">llvm::ConstantSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01376">SelectionDAGNodes.h:1376</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00410">SmallVector.h:410</a></div></div>
<div class="ttc" id="classllvm_1_1CallSiteBase_html_ae4c67f835911559821939fb23a2e7aff"><div class="ttname"><a href="classllvm_1_1CallSiteBase.html#ae4c67f835911559821939fb23a2e7aff">llvm::CallSiteBase::getInstruction</a></div><div class="ttdeci">InstrTy * getInstruction() const </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00079">CallSite.h:79</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a9ab095a80bdcdd7bd24a024212d74f78"><div class="ttname"><a href="StatepointLowering_8cpp.html#a9ab095a80bdcdd7bd24a024212d74f78">spillIncomingStatepointValue</a></div><div class="ttdeci">static std::pair&lt; SDValue, SDValue &gt; spillIncomingStatepointValue(SDValue Incoming, SDValue Chain, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00339">StatepointLowering.cpp:339</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a6cdb26e5268cc05eb7f9726a140f1ae2"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a6cdb26e5268cc05eb7f9726a140f1ae2">llvm::StatepointLoweringState::isStackSlotAllocated</a></div><div class="ttdeci">bool isStackSlotAllocated(int Offset)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00111">StatepointLowering.h:111</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00032">SmallSet.h:32</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_abf7344c24b84a77026aeba3707040282"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#abf7344c24b84a77026aeba3707040282">llvm::SelectionDAGBuilder::LowerCallTo</a></div><div class="ttdeci">void LowerCallTo(ImmutableCallSite CS, SDValue Callee, bool IsTailCall, MachineBasicBlock *LandingPad=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8cpp_source.html#l05705">SelectionDAGBuilder.cpp:5705</a></div></div>
<div class="ttc" id="classllvm_1_1GCFunctionInfo_html_ab94a270eed698fd72d991d5dd8393e01"><div class="ttname"><a href="classllvm_1_1GCFunctionInfo.html#ab94a270eed698fd72d991d5dd8393e01">llvm::GCFunctionInfo::getStrategy</a></div><div class="ttdeci">GCStrategy &amp; getStrategy()</div><div class="ttdef"><b>Definition:</b> <a href="GCMetadata_8h_source.html#l00117">GCMetadata.h:117</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a4841be2489ba10321338a1874b53f249"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a4841be2489ba10321338a1874b53f249">llvm::StatepointLoweringState::allocateStackSlot</a></div><div class="ttdeci">SDValue allocateStackSlot(EVT ValueType, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00065">StatepointLowering.cpp:65</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a2651c31aeb22030422cc4e9ef6c21e22"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a2651c31aeb22030422cc4e9ef6c21e22">llvm::StatepointLoweringState::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00056">StatepointLowering.cpp:56</a></div></div>
<div class="ttc" id="classllvm_1_1Statepoint_html"><div class="ttname"><a href="classllvm_1_1Statepoint.html">llvm::Statepoint</a></div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00165">Statepoint.h:165</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a892daa20eb21173ba89e9fe9702e7f6c"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a892daa20eb21173ba89e9fe9702e7f6c">llvm::SmallSet::insert</a></div><div class="ttdeci">std::pair&lt; NoneType, bool &gt; insert(const T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00069">SmallSet.h:69</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_a5dfe0b79aa455d1f0665bec48042f102"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#a5dfe0b79aa455d1f0665bec48042f102">llvm::SelectionDAGBuilder::getCurSDLoc</a></div><div class="ttdeci">SDLoc getCurSDLoc() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00592">SelectionDAGBuilder.h:592</a></div></div>
<div class="ttc" id="classllvm_1_1GCRelocateOperands_html"><div class="ttname"><a href="classllvm_1_1GCRelocateOperands.html">llvm::GCRelocateOperands</a></div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00176">Statepoint.h:176</a></div></div>
<div class="ttc" id="classllvm_1_1GCStrategy_html_a01d50a4fd2b2151f9788b0f64d98f43f"><div class="ttname"><a href="classllvm_1_1GCStrategy.html#a01d50a4fd2b2151f9788b0f64d98f43f">llvm::GCStrategy::isGCManagedPointer</a></div><div class="ttdeci">virtual Optional&lt; bool &gt; isGCManagedPointer(const Value *V) const </div><div class="ttdef"><b>Definition:</b> <a href="GCStrategy_8h_source.html#l00113">GCStrategy.h:113</a></div></div>
<div class="ttc" id="structllvm_1_1EVT_html"><div class="ttname"><a href="structllvm_1_1EVT.html">llvm::EVT</a></div><div class="ttdef"><b>Definition:</b> <a href="ValueTypes_8h_source.html#l00031">ValueTypes.h:31</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_ad54481e3c992b555aeaba34a83daf7e6"><div class="ttname"><a href="classllvm_1_1CallInst.html#ad54481e3c992b555aeaba34a83daf7e6">llvm::CallInst::setTailCall</a></div><div class="ttdeci">void setTailCall(bool isTC=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01317">Instructions.h:1317</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a2afe36f1344e00c9ef5f8cdb39d21890"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a2afe36f1344e00c9ef5f8cdb39d21890">llvm::SelectionDAG::getRoot</a></div><div class="ttdeci">const SDValue &amp; getRoot() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00330">SelectionDAG.h:330</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionLoweringInfo_html_a9691f14813e0540e6a1c90cfdad39df3"><div class="ttname"><a href="classllvm_1_1FunctionLoweringInfo.html#a9691f14813e0540e6a1c90cfdad39df3">llvm::FunctionLoweringInfo::StatepointStackSlots</a></div><div class="ttdeci">SmallVector&lt; unsigned, 50 &gt; StatepointStackSlots</div><div class="ttdef"><b>Definition:</b> <a href="FunctionLoweringInfo_8h_source.html#l00095">FunctionLoweringInfo.h:95</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a3de9644ea2dd81453acf760bd2c1f921"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a3de9644ea2dd81453acf760bd2c1f921">llvm::SelectionDAG::CreateStackTemporary</a></div><div class="ttdeci">SDValue CreateStackTemporary(EVT VT, unsigned minAlign=1)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01761">SelectionDAG.cpp:1761</a></div></div>
<div class="ttc" id="namespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a6feb9a82882ea426db5b62f3f69f63a2"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a6feb9a82882ea426db5b62f3f69f63a2">llvm::ISD::CALLSEQ_END</a></div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00577">ISDOpcodes.h:577</a></div></div>
<div class="ttc" id="classllvm_1_1SmallSet_html_a75238c8d967e3014bc35c24c843c230f"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a75238c8d967e3014bc35c24c843c230f">llvm::SmallSet::count</a></div><div class="ttdeci">size_type count(const T &amp;V) const </div><div class="ttdoc">count - Return 1 if the element is in the set, 0 otherwise. </div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00053">SmallSet.h:53</a></div></div>
<div class="ttc" id="classllvm_1_1GCRelocateOperands_html_a92998e4f3f83347477cd3d072daa0a86"><div class="ttname"><a href="classllvm_1_1GCRelocateOperands.html#a92998e4f3f83347477cd3d072daa0a86">llvm::GCRelocateOperands::basePtr</a></div><div class="ttdeci">Value * basePtr()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00205">Statepoint.h:205</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_ad997f08bfd4680a697130632badf740e"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#ad997f08bfd4680a697130632badf740e">llvm::SelectionDAGBuilder::DAG</a></div><div class="ttdeci">SelectionDAG &amp; DAG</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00509">SelectionDAGBuilder.h:509</a></div></div>
<div class="ttc" id="StackMaps_8h_html"><div class="ttname"><a href="StackMaps_8h.html">StackMaps.h</a></div></div>
<div class="ttc" id="AArch64ISelLowering_8cpp_html_a62766c75f88612ffa652342472e755f6"><div class="ttname"><a href="AArch64ISelLowering_8cpp.html#a62766c75f88612ffa652342472e755f6">getIntrinsicID</a></div><div class="ttdeci">static unsigned getIntrinsicID(const SDNode *N)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8cpp_source.html#l05464">AArch64ISelLowering.cpp:5464</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00047">Constants.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00882">SmallVector.h:882</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdoc">All values are typed, get the type of this value. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00222">Value.h:222</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_a73349916f7e54a6b988a3646c7a02e90a48a8d9481765073621e8eb71b3f7c88f"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a73349916f7e54a6b988a3646c7a02e90a48a8d9481765073621e8eb71b3f7c88f">llvm::Intrinsic::experimental_gc_statepoint</a></div><div class="ttdef"><b>Definition:</b> <a href="Intrinsics_8h_source.html#l00466">Intrinsics.h:466</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a9a66b00ea9db7d80bf1bcbbcaa108239"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a9a66b00ea9db7d80bf1bcbbcaa108239">llvm::SelectionDAG::getIntPtrConstant</a></div><div class="ttdeci">SDValue getIntPtrConstant(uint64_t Val, bool isTarget=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01182">SelectionDAG.cpp:1182</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_afacdb603af4837437f4e9f7d8fa4f87c"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#afacdb603af4837437f4e9f7d8fa4f87c">llvm::SelectionDAG::getTargetConstant</a></div><div class="ttdeci">SDValue getTargetConstant(uint64_t Val, EVT VT, bool isOpaque=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00434">SelectionDAG.h:434</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html"><div class="ttname"><a href="classllvm_1_1SDNode.html">llvm::SDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00344">SelectionDAGNodes.h:344</a></div></div>
<div class="ttc" id="Statepoint_8h_html"><div class="ttname"><a href="Statepoint_8h.html">Statepoint.h</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a61b235461056cb2459ac87b660426c90"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a61b235461056cb2459ac87b660426c90">llvm::StatepointLoweringState::setLocation</a></div><div class="ttdeci">void setLocation(SDValue val, SDValue Location)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00054">StatepointLowering.h:54</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_a9b4db8b8082660004fda0c282da0ff0a"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#a9b4db8b8082660004fda0c282da0ff0a">llvm::SelectionDAGBuilder::GFI</a></div><div class="ttdeci">GCFunctionInfo * GFI</div><div class="ttdoc">GFI - Garbage collection metadata for the function. </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00540">SelectionDAGBuilder.h:540</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a150b33ecedbc8c7803c2db8040fbe3f8"><div class="ttname"><a href="classllvm_1_1CallInst.html#a150b33ecedbc8c7803c2db8040fbe3f8">llvm::CallInst::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01335">Instructions.h:1335</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a31b3b6f388d85fe4cee1f0947e1500b3"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a31b3b6f388d85fe4cee1f0947e1500b3">llvm::StatepointLoweringState::getRelocLocation</a></div><div class="ttdeci">SDValue getRelocLocation(SDValue val)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00068">StatepointLowering.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a20f382e841761654032bf8b4712e805f"><div class="ttname"><a href="classllvm_1_1SDNode.html#a20f382e841761654032bf8b4712e805f">llvm::SDNode::op_begin</a></div><div class="ttdeci">op_iterator op_begin() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00614">SelectionDAGNodes.h:614</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00299">Value.h:299</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a7b778f039f3221dad52383e3ed095842"><div class="ttname"><a href="StatepointLowering_8cpp.html#a7b778f039f3221dad52383e3ed095842">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumSlotsAllocatedForStatepoints,&quot;Number of stack slots allocated for statepoints&quot;)</div></div>
<div class="ttc" id="namespacellvm_html_a3ef25ef75dac918e4dc006b078c49b3e"><div class="ttname"><a href="namespacellvm.html#a3ef25ef75dac918e4dc006b078c49b3e">llvm::dyn_cast</a></div><div class="ttdeci">LLVM_ATTRIBUTE_UNUSED_RESULT std::enable_if&lt; !is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00285">Casting.h:285</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_a94d23373106467003722f7d6c17b1528"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a94d23373106467003722f7d6c17b1528">llvm::SmallVectorImpl::insert</a></div><div class="ttdeci">iterator insert(iterator I, T &amp;&amp;Elt)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00513">SmallVector.h:513</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a39fed9e3fb9323a7eb73cb65409f5586"><div class="ttname"><a href="classllvm_1_1CallInst.html#a39fed9e3fb9323a7eb73cb65409f5586">llvm::CallInst::getAttributes</a></div><div class="ttdeci">const AttributeSet &amp; getAttributes() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01366">Instructions.h:1366</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorTemplateCommon_html_a8a045d250952c0867382a9840ee18fdf"><div class="ttname"><a href="classllvm_1_1SmallVectorTemplateCommon.html#a8a045d250952c0867382a9840ee18fdf">llvm::SmallVectorTemplateCommon::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00111">SmallVector.h:111</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_accd30daeca42d24fa84d08bf702ba4fc"><div class="ttname"><a href="StatepointLowering_8cpp.html#accd30daeca42d24fa84d08bf702ba4fc">lowerCallFromStatepoint</a></div><div class="ttdeci">static SDNode * lowerCallFromStatepoint(const CallInst &amp;CI, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00225">StatepointLowering.cpp:225</a></div></div>
<div class="ttc" id="SelectionDAGBuilder_8h_html"><div class="ttname"><a href="SelectionDAGBuilder_8h.html">SelectionDAGBuilder.h</a></div></div>
<div class="ttc" id="classllvm_1_1SDUse_html"><div class="ttname"><a href="classllvm_1_1SDUse.html">llvm::SDUse</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00253">SelectionDAGNodes.h:253</a></div></div>
<div class="ttc" id="classllvm_1_1GCStrategy_html"><div class="ttname"><a href="classllvm_1_1GCStrategy.html">llvm::GCStrategy</a></div><div class="ttdef"><b>Definition:</b> <a href="GCStrategy_8h_source.html#l00065">GCStrategy.h:65</a></div></div>
<div class="ttc" id="IVUsers_8cpp_html_ac2f338c3f467b3d09613e190d73044a5"><div class="ttname"><a href="IVUsers_8cpp.html#ac2f338c3f467b3d09613e190d73044a5">users</a></div><div class="ttdeci">iv users</div><div class="ttdef"><b>Definition:</b> <a href="IVUsers_8cpp_source.html#l00039">IVUsers.cpp:39</a></div></div>
<div class="ttc" id="StatepointLowering_8cpp_html_a78099da4c0cc5e8d8323326e91a03cf4"><div class="ttname"><a href="StatepointLowering_8cpp.html#a78099da4c0cc5e8d8323326e91a03cf4">removeDuplicatesGCPtrs</a></div><div class="ttdeci">static void removeDuplicatesGCPtrs(SmallVectorImpl&lt; const Value * &gt; &amp;Bases, SmallVectorImpl&lt; const Value * &gt; &amp;Ptrs, SmallVectorImpl&lt; const Value * &gt; &amp;Relocs, SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00193">StatepointLowering.cpp:193</a></div></div>
<div class="ttc" id="classllvm_1_1StackMaps_html_a181f65d4a4da75240c4f105cf644fa1dad60dbfe71ff0c05604ef33b8e82f2529"><div class="ttname"><a href="classllvm_1_1StackMaps.html#a181f65d4a4da75240c4f105cf644fa1dad60dbfe71ff0c05604ef33b8e82f2529">llvm::StackMaps::ConstantOp</a></div><div class="ttdef"><b>Definition:</b> <a href="StackMaps_8h_source.html#l00163">StackMaps.h:163</a></div></div>
<div class="ttc" id="Intrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="classllvm_1_1ImmutableCallSite_html"><div class="ttname"><a href="classllvm_1_1ImmutableCallSite.html">llvm::ImmutableCallSite</a></div><div class="ttdoc">ImmutableCallSite - establish a view to a call site for examination. </div><div class="ttdef"><b>Definition:</b> <a href="CallSite_8h_source.html#l00373">CallSite.h:373</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a307e5150c6c85f43348d2b09a69d7591"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a307e5150c6c85f43348d2b09a69d7591">llvm::SelectionDAG::ReplaceAllUsesWith</a></div><div class="ttdeci">void ReplaceAllUsesWith(SDValue From, SDValue Op)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05859">SelectionDAG.cpp:5859</a></div></div>
<div class="ttc" id="classllvm_1_1FrameIndexSDNode_html"><div class="ttname"><a href="classllvm_1_1FrameIndexSDNode.html">llvm::FrameIndexSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01476">SelectionDAGNodes.h:1476</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_aeb4b5a7ad5a49f17f8a34890eb6efefe"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#aeb4b5a7ad5a49f17f8a34890eb6efefe">llvm::StatepointLoweringState::startNewStatepoint</a></div><div class="ttdeci">void startNewStatepoint(SelectionDAGBuilder &amp;Builder)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8cpp_source.html#l00041">StatepointLowering.cpp:41</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a5e07dea70b41ad610edbfc21bd54154a"><div class="ttname"><a href="classllvm_1_1CallInst.html#a5e07dea70b41ad610edbfc21bd54154a">llvm::CallInst::isTailCall</a></div><div class="ttdeci">bool isTailCall() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01311">Instructions.h:1311</a></div></div>
<div class="ttc" id="classllvm_1_1SDNode_html_a992906781101abb22f6e4d16622bbe24"><div class="ttname"><a href="classllvm_1_1SDNode.html#a992906781101abb22f6e4d16622bbe24">llvm::SDNode::op_end</a></div><div class="ttdeci">op_iterator op_end() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00615">SelectionDAGNodes.h:615</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_afe8c553ab3418eec718860c098c6e080"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#afe8c553ab3418eec718860c098c6e080">llvm::SelectionDAG::getMachineNode</a></div><div class="ttdeci">MachineSDNode * getMachineNode(unsigned Opcode, SDLoc dl, EVT VT)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l05611">SelectionDAG.cpp:5611</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_a77cbbcab1440ac5ef835e1a3d3f6c74e"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#a77cbbcab1440ac5ef835e1a3d3f6c74e">llvm::SelectionDAGBuilder::StatepointLowering</a></div><div class="ttdeci">StatepointLoweringState StatepointLowering</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00122">SelectionDAGBuilder.h:122</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html_a7d2ad4aa4277eb4e1138ff9791c8fbb7"><div class="ttname"><a href="classllvm_1_1SDValue.html#a7d2ad4aa4277eb4e1138ff9791c8fbb7">llvm::SDValue::getValueType</a></div><div class="ttdeci">EVT getValueType() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00918">SelectionDAGNodes.h:918</a></div></div>
<div class="ttc" id="SelectionDAG_8h_html"><div class="ttname"><a href="SelectionDAG_8h.html">SelectionDAG.h</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAGBuilder_html_ad10e64e191507974af84a4ea069a9e36"><div class="ttname"><a href="classllvm_1_1SelectionDAGBuilder.html#ad10e64e191507974af84a4ea069a9e36">llvm::SelectionDAGBuilder::FuncInfo</a></div><div class="ttdeci">FunctionLoweringInfo &amp; FuncInfo</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGBuilder_8h_source.html#l00533">SelectionDAGBuilder.h:533</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_a878ea78eaf07a94c8376112b094d2d6a"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#a878ea78eaf07a94c8376112b094d2d6a">llvm::StatepointLoweringState::getLocation</a></div><div class="ttdeci">SDValue getLocation(SDValue val)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00049">StatepointLowering.h:49</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a179ef4c643fb35a8dc364e4ae63950f9"><div class="ttname"><a href="classllvm_1_1CallInst.html#a179ef4c643fb35a8dc364e4ae63950f9">llvm::CallInst::setAttributes</a></div><div class="ttdeci">void setAttributes(const AttributeSet &amp;Attrs)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01370">Instructions.h:1370</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_acb59cbd8f4a8c1cf820b2b540aebdac1"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#acb59cbd8f4a8c1cf820b2b540aebdac1">llvm::SelectionDAG::getFrameIndex</a></div><div class="ttdeci">SDValue getFrameIndex(int FI, EVT VT, bool isTarget=false)</div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8cpp_source.html#l01278">SelectionDAG.cpp:1278</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00068">Value.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_aca8f1320bf0f665f1ec1843fce82384c"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#aca8f1320bf0f665f1ec1843fce82384c">llvm::StatepointLoweringState::scheduleRelocCall</a></div><div class="ttdeci">void scheduleRelocCall(const CallInst &amp;RelocCall)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00082">StatepointLowering.h:82</a></div></div>
<div class="ttc" id="namespacellvm_1_1TargetOpcode_html_a545ed70cd7fddb78f8a9200e31d7b5a4a9a5e04a47bc910a73cada89ff3aa66fa"><div class="ttname"><a href="namespacellvm_1_1TargetOpcode.html#a545ed70cd7fddb78f8a9200e31d7b5a4a9a5e04a47bc910a73cada89ff3aa66fa">llvm::TargetOpcode::STATEPOINT</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00119">TargetOpcodes.h:119</a></div></div>
<div class="ttc" id="classllvm_1_1SelectionDAG_html_a848b46af8fabd1ab34b28adbc3665609"><div class="ttname"><a href="classllvm_1_1SelectionDAG.html#a848b46af8fabd1ab34b28adbc3665609">llvm::SelectionDAG::getTargetLoweringInfo</a></div><div class="ttdeci">const TargetLowering &amp; getTargetLoweringInfo() const </div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAG_8h_source.html#l00285">SelectionDAG.h:285</a></div></div>
<div class="ttc" id="classllvm_1_1StatepointLoweringState_html_ab72dadb5010ec0fd29e51b96d29345fb"><div class="ttname"><a href="classllvm_1_1StatepointLoweringState.html#ab72dadb5010ec0fd29e51b96d29345fb">llvm::StatepointLoweringState::relocCallVisited</a></div><div class="ttdeci">void relocCallVisited(const CallInst &amp;RelocCall)</div><div class="ttdef"><b>Definition:</b> <a href="StatepointLowering_8h_source.html#l00088">StatepointLowering.h:88</a></div></div>
<div class="ttc" id="classllvm_1_1CallInst_html_a2a65eaf09953a013c2820f6857c647f0"><div class="ttname"><a href="classllvm_1_1CallInst.html#a2a65eaf09953a013c2820f6857c647f0">llvm::CallInst::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01356">Instructions.h:1356</a></div></div>
<div class="ttc" id="classllvm_1_1SDValue_html"><div class="ttname"><a href="classllvm_1_1SDValue.html">llvm::SDValue</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l00119">SelectionDAGNodes.h:119</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">llvm::CallingConv::C</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00034">CallingConv.h:34</a></div></div>
<div class="ttc" id="TargetLowering_8h_html"><div class="ttname"><a href="TargetLowering_8h.html">TargetLowering.h</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_af5c7041df3ad5edffe5da17b5264c1fc"><div class="ttname"><a href="classllvm_1_1Type.html#af5c7041df3ad5edffe5da17b5264c1fc">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const </div><div class="ttdoc">isVoidTy - Return true if this is &#39;void&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00137">Type.h:137</a></div></div>
<div class="ttc" id="classllvm_1_1PointerUnion_html"><div class="ttname"><a href="classllvm_1_1PointerUnion.html">llvm::PointerUnion&lt; const Value *, const PseudoSourceValue * &gt;</a></div></div>
<div class="ttc" id="classllvm_1_1GCRelocateOperands_html_a026ba096a24e3e753d8faeee17bb5a99"><div class="ttname"><a href="classllvm_1_1GCRelocateOperands.html#a026ba096a24e3e753d8faeee17bb5a99">llvm::GCRelocateOperands::derivedPtr</a></div><div class="ttdeci">Value * derivedPtr()</div><div class="ttdef"><b>Definition:</b> <a href="Statepoint_8h_source.html#l00209">Statepoint.h:209</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVectorImpl_html_ad0b3d8447f88377b62d9c019f3c4e118"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#ad0b3d8447f88377b62d9c019f3c4e118">llvm::SmallVectorImpl::resize</a></div><div class="ttdeci">void resize(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00415">SmallVector.h:415</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_ab829c5fd1bbf60f869608ba1143be151"><div class="ttname"><a href="classllvm_1_1User.html#ab829c5fd1bbf60f869608ba1143be151">llvm::User::const_op_iterator</a></div><div class="ttdeci">const Use * const_op_iterator</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00115">User.h:115</a></div></div>
<div class="ttc" id="classllvm_1_1LoadSDNode_html"><div class="ttname"><a href="classllvm_1_1LoadSDNode.html">llvm::LoadSDNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SelectionDAGNodes_8h_source.html#l01883">SelectionDAGNodes.h:1883</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr>
<p class="footer">
Generated on Tue Dec 8 2015 00:57:12 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.6</a><br>
Copyright &copy; 2003-2014 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
