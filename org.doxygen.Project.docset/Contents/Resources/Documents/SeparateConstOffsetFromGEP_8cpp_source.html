<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="LLVM,Low Level Virtual Machine,C++,doxygen,API,documentation"/>
<meta name="description" content="C++ source code API documentation for LLVM."/>
<title>LLVM: SeparateConstOffsetFromGEP.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">LLVM API Documentation</p>
<!-- Generated by Doxygen 1.8.6 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4d9c1978b5f07b6adb33a8870a898946.html">llvm3.6</a></li><li class="navelem"><a class="el" href="dir_5fa7ecd8d95c317b32615506984470d8.html">lib</a></li><li class="navelem"><a class="el" href="dir_ed2be07ed72f5c44fcceed313c4db32e.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_89056b0515ef76ff397e0d3d537b17dc.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SeparateConstOffsetFromGEP.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SeparateConstOffsetFromGEP_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- SeparateConstOffsetFromGEP.cpp - ------------------------*- C++ -*-===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//                     The LLVM Compiler Infrastructure</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is distributed under the University of Illinois Open Source</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// License. See LICENSE.TXT for details.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Loop unrolling may create many similar GEPs for array accesses.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// e.g., a 2-level loop</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// float a[32][32]; // global variable</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// for (int i = 0; i &lt; 2; ++i) {</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//   for (int j = 0; j &lt; 2; ++j) {</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//     ...</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//     ... = a[x + i][y + j];</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//     ...</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// will probably be unrolled to:</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// gep %a, 0, %x, %y; load</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// gep %a, 0, %x, %y + 1; load</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// gep %a, 0, %x + 1, %y; load</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// gep %a, 0, %x + 1, %y + 1; load</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// LLVM&#39;s GVN does not use partial redundancy elimination yet, and is thus</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// unable to reuse (gep %a, 0, %x, %y). As a result, this misoptimization incurs</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// significant slowdown in targets with limited addressing modes. For instance,</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// because the PTX target does not support the reg+reg addressing mode, the</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// NVPTX backend emits PTX code that literally computes the pointer address of</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// each GEP, wasting tons of registers. It emits the following PTX for the</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// first load and similar PTX for other loads.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// mov.u32         %r1, %x;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// mov.u32         %r2, %y;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// mul.wide.u32    %rl2, %r1, 128;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// mov.u64         %rl3, a;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// add.s64         %rl4, %rl3, %rl2;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// mul.wide.u32    %rl5, %r2, 4;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// add.s64         %rl6, %rl4, %rl5;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// ld.global.f32   %f1, [%rl6];</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// To reduce the register pressure, the optimization implemented in this file</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// merges the common part of a group of GEPs, so we can compute each pointer</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// address by adding a simple offset to the common part, saving many registers.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// It works by splitting each GEP into a variadic base and a constant offset.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// The variadic base can be computed once and reused by multiple GEPs, and the</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// constant offsets can be nicely folded into the reg+immediate addressing mode</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// (supported by most targets) without using any extra register.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// For instance, we transform the four GEPs and four loads in the above example</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// into:</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// base = gep a, 0, x, y</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// load base</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// laod base + 1  * sizeof(float)</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// load base + 32 * sizeof(float)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// load base + 33 * sizeof(float)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// Given the transformed IR, a backend that supports the reg+immediate</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">// addressing mode can easily fold the pointer arithmetics into the loads. For</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// example, the NVPTX backend can easily fold the pointer arithmetics into the</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// ld.global.f32 instructions, and the resultant PTX uses much fewer registers.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// mov.u32         %r1, %tid.x;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">// mov.u32         %r2, %tid.y;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// mul.wide.u32    %rl2, %r1, 128;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// mov.u64         %rl3, a;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// add.s64         %rl4, %rl3, %rl2;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// mul.wide.u32    %rl5, %r2, 4;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">// add.s64         %rl6, %rl4, %rl5;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// ld.global.f32   %f1, [%rl6]; // so far the same as unoptimized PTX</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// ld.global.f32   %f2, [%rl6+4]; // much better</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// ld.global.f32   %f3, [%rl6+128]; // much better</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// ld.global.f32   %f4, [%rl6+132]; // much better</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// Another improvement enabled by the LowerGEP flag is to lower a GEP with</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// multiple indices to either multiple GEPs with a single index or arithmetic</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// operations (depending on whether the target uses alias analysis in codegen).</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// Such transformation can have following benefits:</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// (1) It can always extract constants in the indices of structure type.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">// (2) After such Lowering, there are more optimization opportunities such as</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//     CSE, LICM and CGP.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">// E.g. The following GEPs have multiple indices:</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//  BB1:</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//    %p = getelementptr [10 x %struct]* %ptr, i64 %i, i64 %j1, i32 3</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//    load %p</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//  BB2:</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//    %p2 = getelementptr [10 x %struct]* %ptr, i64 %i, i64 %j1, i32 2</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//    load %p2</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// We can not do CSE for to the common part related to index &quot;i64 %i&quot;. Lowering</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// GEPs can achieve such goals.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// If the target does not use alias analysis in codegen, this pass will</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// lower a GEP with multiple indices into arithmetic operations:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//  BB1:</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//    %1 = ptrtoint [10 x %struct]* %ptr to i64    ; CSE opportunity</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//    %2 = mul i64 %i, length_of_10xstruct         ; CSE opportunity</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">//    %3 = add i64 %1, %2                          ; CSE opportunity</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//    %4 = mul i64 %j1, length_of_struct</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//    %5 = add i64 %3, %4</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//    %6 = add i64 %3, struct_field_3              ; Constant offset</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//    %p = inttoptr i64 %6 to i32*</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//    load %p</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">//  BB2:</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">//    %7 = ptrtoint [10 x %struct]* %ptr to i64    ; CSE opportunity</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">//    %8 = mul i64 %i, length_of_10xstruct         ; CSE opportunity</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">//    %9 = add i64 %7, %8                          ; CSE opportunity</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">//    %10 = mul i64 %j2, length_of_struct</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//    %11 = add i64 %9, %10</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//    %12 = add i64 %11, struct_field_2            ; Constant offset</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//    %p = inttoptr i64 %12 to i32*</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">//    load %p2</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// If the target uses alias analysis in codegen, this pass will lower a GEP</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// with multiple indices into multiple GEPs with a single index:</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//  BB1:</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//    %1 = bitcast [10 x %struct]* %ptr to i8*     ; CSE opportunity</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//    %2 = mul i64 %i, length_of_10xstruct         ; CSE opportunity</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//    %3 = getelementptr i8* %1, i64 %2            ; CSE opportunity</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">//    %4 = mul i64 %j1, length_of_struct</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//    %5 = getelementptr i8* %3, i64 %4</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">//    %6 = getelementptr i8* %5, struct_field_3    ; Constant offset</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//    %p = bitcast i8* %6 to i32*</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">//    load %p</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">//  BB2:</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//    %7 = bitcast [10 x %struct]* %ptr to i8*     ; CSE opportunity</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//    %8 = mul i64 %i, length_of_10xstruct         ; CSE opportunity</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//    %9 = getelementptr i8* %7, i64 %8            ; CSE opportunity</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//    %10 = mul i64 %j2, length_of_struct</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//    %11 = getelementptr i8* %9, i64 %10</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//    %12 = getelementptr i8* %11, struct_field_2  ; Constant offset</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//    %p2 = bitcast i8* %12 to i32*</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//    load %p2</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">// Lowering GEPs can also benefit other passes such as LICM and CGP.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// LICM (Loop Invariant Code Motion) can not hoist/sink a GEP of multiple</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">// indices if one of the index is variant. If we lower such GEP into invariant</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">// parts and variant parts, LICM can hoist/sink those invariant parts.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// CGP (CodeGen Prepare) tries to sink address calculations that match the</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// target&#39;s addressing modes. A GEP with multiple indices may not match and will</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// not be sunk. If we lower such GEP into smaller parts, CGP may sink some of</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// them. So we end up with a better addressing mode.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Operator_8h.html">llvm/IR/Operator.h</a>&quot;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSubtargetInfo_8h.html">llvm/Target/TargetSubtargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">using namespace </span>llvm;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#a60bf5a3fac0ddb0ce045a4f4cbf90def">DisableSeparateConstOffsetFromGEP</a>(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="stringliteral">&quot;disable-separate-const-offset-from-gep&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Do not separate the constant offset from a GEP instruction&quot;</span>),</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">/// \brief A helper class for separating a constant offset from a GEP index.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/// In real programs, a GEP index may be more complicated than a simple addition</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/// of something and a constant integer which can be trivially splitted. For</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/// example, to split ((a &lt;&lt; 3) | 5) + b, we need to search deeper for the</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">/// constant offset, so that we can separate the index to (a &lt;&lt; 3) + b and 5.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/// Therefore, this class looks into the expression that computes a given GEP</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/// index, and tries to find a constant integer that can be hoisted to the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/// outermost level of the expression as an addition. Not every constant in an</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/// expression can jump out. e.g., we cannot transform (b * (a + 5)) to (b * a +</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/// 5); nor can we transform (3 * (a + 5)) to (3 * a + 5), however in this case,</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/// -instcombine probably already optimized (3 * (a + 5)) to (3 * a + 15).</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span><span class="keyword">class </span>ConstantOffsetExtractor {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  /// Extracts a constant offset from the given GEP index. It returns the</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  /// new index representing the remainder (equal to the original index minus</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  /// the constant offset), or nullptr if we cannot extract a constant offset.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  /// \p Idx    The given GEP index</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">  /// \p DL     The datalayout of the module</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  /// \p GEP    The given GEP</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *Extract(<a class="code" href="classllvm_1_1Value.html">Value</a> *Idx, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP);<span class="comment"></span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  /// Looks for a constant offset from the given GEP index without extracting</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">  /// it. It returns the numeric value of the extracted constant offset (0 if</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  /// failed). The meaning of the arguments are the same as Extract.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> int64_t <a class="code" href="SubtargetFeature_8cpp.html#a8fcfa092cd65f49abe6b6dd7c9ae11fe">Find</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Idx, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>, <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  ConstantOffsetExtractor(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *Layout, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPt)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      : <a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>(Layout), IP(InsertionPt) {}<span class="comment"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">  /// Searches the expression that computes V for a non-zero constant C s.t.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">  /// V can be reassociated into the form V&#39; + C. If the searching is</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">  /// successful, returns C and update UserChain as a def-use chain from C to V;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  /// otherwise, UserChain is empty.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  /// \p V            The given expression</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  /// \p SignExtended Whether V will be sign-extended in the computation of the</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">  ///                 GEP index</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  /// \p ZeroExtended Whether V will be zero-extended in the computation of the</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  ///                 GEP index</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  /// \p NonNegative  Whether V is guaranteed to be non-negative. For example,</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">  ///                 an index of an inbounds GEP is guaranteed to be</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">  ///                 non-negative. Levaraging this, we can better split</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">  ///                 inbounds GEPs.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1APInt.html">APInt</a> find(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">bool</span> SignExtended, <span class="keywordtype">bool</span> ZeroExtended, <span class="keywordtype">bool</span> NonNegative);<span class="comment"></span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">  /// A helper function to look into both operands of a binary operator.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1APInt.html">APInt</a> findInEitherOperand(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO, <span class="keywordtype">bool</span> SignExtended,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                            <span class="keywordtype">bool</span> ZeroExtended);<span class="comment"></span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  /// After finding the constant offset C from the GEP index I, we build a new</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  /// index I&#39; s.t. I&#39; + C = I. This function builds and returns the new</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  /// index I&#39; according to UserChain produced by function &quot;find&quot;.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  /// The building conceptually takes two steps:</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">  /// 1) iteratively distribute s/zext towards the leaves of the expression tree</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  /// that computes I</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  /// 2) reassociate the expression tree to the form I&#39; + C.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  /// For example, to extract the 5 from sext(a + (b + 5)), we first distribute</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  /// sext to a, b and 5 so that we have</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">  ///   sext(a) + (sext(b) + 5).</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  /// Then, we reassociate it to</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">  ///   (sext(a) + sext(b)) + 5.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">  /// Given this form, we know I&#39; is sext(a) + sext(b).</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *rebuildWithoutConstOffset();<span class="comment"></span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  /// After the first step of rebuilding the GEP index without the constant</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">  /// offset, distribute s/zext to the operands of all operators in UserChain.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  /// e.g., zext(sext(a + (b + 5)) (assuming no overflow) =&gt;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  /// zext(sext(a)) + (zext(sext(b)) + zext(sext(5))).</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">  /// The function also updates UserChain to point to new subexpressions after</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// distributing s/zext. e.g., the old UserChain of the above example is</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  /// 5 -&gt; b + 5 -&gt; a + (b + 5) -&gt; sext(...) -&gt; zext(sext(...)),</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  /// and the new UserChain is</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  /// zext(sext(5)) -&gt; zext(sext(b)) + zext(sext(5)) -&gt;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  ///   zext(sext(a)) + (zext(sext(b)) + zext(sext(5))</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// \p ChainIndex The index to UserChain. ChainIndex is initially</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">  ///               UserChain.size() - 1, and is decremented during</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">  ///               the recursion.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *distributeExtsAndCloneChain(<span class="keywordtype">unsigned</span> ChainIndex);<span class="comment"></span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">  /// Reassociates the GEP index to the form I&#39; + C and returns I&#39;.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *removeConstOffset(<span class="keywordtype">unsigned</span> ChainIndex);<span class="comment"></span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">  /// A helper function to apply ExtInsts, a list of s/zext, to value V.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">  /// e.g., if ExtInsts = [sext i32 to i64, zext i16 to i32], this function</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">  /// returns &quot;sext i32 (zext i16 V to i32) to i64&quot;.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *applyExts(<a class="code" href="classllvm_1_1Value.html">Value</a> *V);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  /// Returns true if LHS and RHS have no bits in common, i.e., LHS | RHS == 0.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> NoCommonBits(<a class="code" href="classllvm_1_1Value.html">Value</a> *LHS, <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">  /// Computes which bits are known to be one or zero.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">  /// \p KnownOne Mask of all bits that are known to be one.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">  /// \p KnownZero Mask of all bits that are known to be zero.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> ComputeKnownBits(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;KnownOne, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;KnownZero) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /// A helper function that returns whether we can trace into the operands</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">  /// of binary operator BO for a constant offset.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  /// \p SignExtended Whether BO is surrounded by sext</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// \p ZeroExtended Whether BO is surrounded by zext</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">  /// \p NonNegative Whether BO is known to be non-negative, e.g., an in-bound</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  ///                array index.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> CanTraceInto(<span class="keywordtype">bool</span> SignExtended, <span class="keywordtype">bool</span> ZeroExtended, <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordtype">bool</span> NonNegative);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">  /// The path from the constant offset to the old GEP index. e.g., if the GEP</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">  /// index is &quot;a * b + (c + 5)&quot;. After running function find, UserChain[0] will</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">  /// be the constant 5, UserChain[1] will be the subexpression &quot;c + 5&quot;, and</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">  /// UserChain[2] will be the entire expression &quot;a * b + (c + 5)&quot;.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">  /// This path helps to rebuild the new GEP index.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;User *, 8&gt;</a> UserChain;<span class="comment"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  /// A data structure used in rebuildWithoutConstOffset. Contains all</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  /// sext/zext instructions along UserChain.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CastInst *, 16&gt;</a> ExtInsts;<span class="comment"></span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  /// The data layout of the module. Used in ComputeKnownBits.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IP;  <span class="comment">/// Insertion position of cloned instructions.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span>};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/// \brief A pass that tries to split every GEP in the function into a variadic</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/// base and a constant offset. It is a FunctionPass because searching for the</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/// constant offset may inspect other basic blocks.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span><span class="keyword">class </span>SeparateConstOffsetFromGEP : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="ARMAsmParser_8cpp.html#afa41b5544267a2f619f358964a81c0e9">ID</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  SeparateConstOffsetFromGEP(<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a> = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                             <span class="keywordtype">bool</span> LowerGEP = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="ARMAsmParser_8cpp.html#afa41b5544267a2f619f358964a81c0e9">ID</a>), <a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a>(<a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a>), LowerGEP(LowerGEP) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="namespacellvm.html#a10b98151467b7d7549f2ec334aabaf2d">initializeSeparateConstOffsetFromGEPPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DataLayoutPass.html">DataLayoutPass</a>&gt;();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>&gt;();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">bool</span> doInitialization(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classllvm_1_1DataLayoutPass.html">DataLayoutPass</a> *DLP = getAnalysisIfAvailable&lt;DataLayoutPass&gt;();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (DLP == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">report_fatal_error</a>(<span class="stringliteral">&quot;data layout missing&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a> = &amp;DLP-&gt;<a class="code" href="classllvm_1_1DataLayoutPass.html#a2e204d18cc1dd3f4df97bb8e18b2cf67">getDataLayout</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">bool</span> runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">  /// Tries to split the given GEP into a variadic base and a constant offset,</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">  /// and returns true if the splitting succeeds.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> splitGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP);<span class="comment"></span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  /// Lower a GEP with multiple indices into multiple GEPs with a single index.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  /// Function splitGEP already split the original GEP into a variadic part and</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  /// a constant offset (i.e., AccumulativeByteOffset). This function lowers the</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  /// variadic part into a set of GEPs with a single index and applies</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  /// AccumulativeByteOffset to it.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  /// \p Variadic                  The variadic part of the original GEP.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">  /// \p AccumulativeByteOffset    The constant offset.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> lowerToSingleIndexGEPs(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#a5eb9635f629c61db37d13202cde65881a06448010e7faa3713221a1b768380957">Variadic</a>,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                              int64_t AccumulativeByteOffset);<span class="comment"></span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  /// Lower a GEP with multiple indices into ptrtoint+arithmetics+inttoptr form.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">  /// Function splitGEP already split the original GEP into a variadic part and</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">  /// a constant offset (i.e., AccumulativeByteOffset). This function lowers the</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  /// variadic part into a set of arithmetic operations and applies</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  /// AccumulativeByteOffset to it.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">  /// \p Variadic                  The variadic part of the original GEP.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  /// \p AccumulativeByteOffset    The constant offset.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> lowerToArithmetics(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#a5eb9635f629c61db37d13202cde65881a06448010e7faa3713221a1b768380957">Variadic</a>,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                          int64_t AccumulativeByteOffset);<span class="comment"></span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  /// Finds the constant offset within each index and accumulates them. If</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  /// LowerGEP is true, it finds in indices of both sequential and structure</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  /// types, otherwise it only finds in sequential indices. The output</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  /// NeedsExtraction indicates whether we successfully find a non-zero constant</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">  /// offset.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span>  int64_t accumulateByteOffset(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP, <span class="keywordtype">bool</span> &amp;NeedsExtraction);<span class="comment"></span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">  /// Canonicalize array indices to pointer-size integers. This helps to</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  /// simplify the logic of splitting a GEP. For example, if a + b is a</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /// pointer-size integer, we have</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  ///   gep base, a + b = gep (gep base, a), b</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  /// However, this equality may not hold if the size of a + b is smaller than</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  /// the pointer size, because LLVM conceptually sign-extends GEP indices to</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  /// pointer size before computing the address</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">  /// (http://llvm.org/docs/LangRef.html#id181).</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">  /// This canonicalization is very likely already done in clang and</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  /// instcombine. Therefore, the program will probably remain the same.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  /// Returns true if the module changes.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  /// Verified in @i32_add in split-gep.ll</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canonicalizeArrayIndicesToPointerSize(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a>;<span class="comment"></span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">  /// Whether to lower a GEP with multiple indices into arithmetic operations or</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  /// multiple GEPs with a single index.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> LowerGEP;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;};</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}  <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordtype">char</span> <a class="code" href="ARMAsmParser_8cpp.html#afa41b5544267a2f619f358964a81c0e9">SeparateConstOffsetFromGEP::ID</a> = 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#ad564a5d5b29208c8c75ad21a23404191">INITIALIZE_PASS_BEGIN</a>(</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    SeparateConstOffsetFromGEP, <span class="stringliteral">&quot;separate-const-offset-from-gep&quot;</span>,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="stringliteral">&quot;Split GEPs to a variadic base and a constant offset for better CSE&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keyword">false</span>)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<a class="code" href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<a class="code" href="ForwardControlFlowIntegrity_8cpp.html#aa6d14665c3f65bf28901537cc0fc8d71">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DataLayoutPass.html">DataLayoutPass</a>)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(</div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="SeparateConstOffsetFromGEP_8cpp.html#a589d62ce2ac872ff25beaad782d27235">  390</a></span>&#160;    SeparateConstOffsetFromGEP, &quot;separate-<a class="code" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a>-offset-from-<a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#a589d62ce2ac872ff25beaad782d27235">gep</a>&quot;,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    &quot;<a class="code" href="SubtargetFeature_8cpp.html#a7b9259d83f899b40e4a03159c5bbd017">Split</a> GEPs to a variadic base and a constant offset <a class="code" href="DeadMachineInstructionElim_8cpp.html#a315d40774fd009fbbb69237b11f26525">for</a> better <a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#ac56c14d91bc69a17e4e5936093b3bc05">CSE</a>&quot;, <a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#aea3fbd426f5c98c2645e4050c2d8722a">false</a>,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    false)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *</div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="namespacellvm.html#aa60a21f5ff7be725dc1b4d3f850e6d4a">  395</a></span>&#160;llvm::<a class="code" href="namespacellvm.html#aa60a21f5ff7be725dc1b4d3f850e6d4a">createSeparateConstOffsetFromGEPPass</a>(<a class="code" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a>,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                           <span class="keywordtype">bool</span> LowerGEP) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> SeparateConstOffsetFromGEP(TM, LowerGEP);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordtype">bool</span> ConstantOffsetExtractor::CanTraceInto(<span class="keywordtype">bool</span> SignExtended,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                            <span class="keywordtype">bool</span> ZeroExtended,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                            <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                            <span class="keywordtype">bool</span> NonNegative) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// We only consider ADD, SUB and OR, because a non-zero constant found in</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// expressions composed of these operations can be easily hoisted as a</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// constant offset by reassociation.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() != <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caaec211f7c20af43e742bf2570c3cb84f9">Instruction::Add</a> &amp;&amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() != <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2">Instruction::Sub</a> &amp;&amp;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() != <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHS = BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), *RHS = BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// Do not trace into &quot;or&quot; unless it is equivalent to &quot;add&quot;. If LHS and RHS</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// don&#39;t have common bits, (LHS | RHS) is equivalent to (LHS + RHS).</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a> &amp;&amp; !NoCommonBits(LHS, RHS))</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// In addition, tracing into BO requires that its surrounding s/zext (if</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// any) is distributable to both operands.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// Suppose BO = A op B.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">//  SignExtended | ZeroExtended | Distributable?</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// --------------+--------------+----------------------------------</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">//       0       |      0       | true because no s/zext exists</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">//       0       |      1       | zext(BO) == zext(A) op zext(B)</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//       1       |      0       | sext(BO) == sext(A) op sext(B)</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">//       1       |      1       | zext(sext(BO)) ==</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">//               |              |     zext(sext(A)) op zext(sext(B))</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caaec211f7c20af43e742bf2570c3cb84f9">Instruction::Add</a> &amp;&amp; !ZeroExtended &amp;&amp; NonNegative) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// If a + b &gt;= 0 and (a &gt;= 0 or b &gt;= 0), then</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//   sext(a + b) = sext(a) + sext(b)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// even if the addition is not marked nsw.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// Leveraging this invarient, we can trace into an sext&#39;ed inbound GEP</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// index if the constant offset is non-negative.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// Verified in @sext_add in split-gep.ll.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ConstLHS = dyn_cast&lt;ConstantInt&gt;(LHS)) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">if</span> (!ConstLHS-&gt;isNegative())</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ConstRHS = dyn_cast&lt;ConstantInt&gt;(RHS)) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span> (!ConstRHS-&gt;isNegative())</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// sext (add/sub nsw A, B) == add/sub nsw (sext A), (sext B)</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// zext (add/sub nuw A, B) == add/sub nuw (zext A), (zext B)</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caaec211f7c20af43e742bf2570c3cb84f9">Instruction::Add</a> ||</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2">Instruction::Sub</a>) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (SignExtended &amp;&amp; !BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">hasNoSignedWrap</a>())</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> (ZeroExtended &amp;&amp; !BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">hasNoUnsignedWrap</a>())</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstantOffsetExtractor::findInEitherOperand(<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                                   <span class="keywordtype">bool</span> SignExtended,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                                   <span class="keywordtype">bool</span> ZeroExtended) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// BO being non-negative does not shed light on whether its operands are</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// non-negative. Clear the NonNegative flag here.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstantOffset = find(BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), SignExtended, ZeroExtended,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                              <span class="comment">/* NonNegative */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">// If we found a constant offset in the left operand, stop and return that.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// This shortcut might cause us to miss opportunities of combining the</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// constant offsets in both operands, e.g., (a + 4) + (b + 5) =&gt; (a + b) + 9.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// However, such cases are probably already handled by -instcombine,</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// given this pass runs after the standard optimizations.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">if</span> (ConstantOffset != 0) <span class="keywordflow">return</span> ConstantOffset;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  ConstantOffset = find(BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1), SignExtended, ZeroExtended,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        <span class="comment">/* NonNegative */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// If U is a sub operator, negate the constant offset found in the right</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// operand.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2">Instruction::Sub</a>)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    ConstantOffset = -ConstantOffset;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">return</span> ConstantOffset;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstantOffsetExtractor::find(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">bool</span> SignExtended,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                    <span class="keywordtype">bool</span> ZeroExtended, <span class="keywordtype">bool</span> NonNegative) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// TODO(jingyue): We could trace into integer/pointer casts, such as</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// inttoptr, ptrtoint, bitcast, and addrspacecast. We choose to handle only</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// integers because it gives good enough results for our benchmarks.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">unsigned</span> BitWidth = cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>())-&gt;<a class="code" href="ValueTracking_8cpp.html#a06c14477546c3a0eb4c79ff007ea2375">getBitWidth</a>();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// We cannot do much with Values that are not a User, such as an Argument.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="classllvm_1_1User.html">User</a> *U = <a class="code" href="namespacellvm.html#a3ef25ef75dac918e4dc006b078c49b3e">dyn_cast</a>&lt;<a class="code" href="classllvm_1_1User.html">User</a>&gt;(V);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">if</span> (U == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a>(BitWidth, 0);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstantOffset(BitWidth, 0);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(V)) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Hooray, we found it!</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    ConstantOffset = CI-&gt;getValue();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = dyn_cast&lt;BinaryOperator&gt;(V)) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// Trace into subexpressions for more hoisting opportunities.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (CanTraceInto(SignExtended, ZeroExtended, BO, NonNegative)) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      ConstantOffset = findInEitherOperand(BO, SignExtended, ZeroExtended);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;SExtInst&gt;(V)) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    ConstantOffset = find(U-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <span class="comment">/* SignExtended */</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                          ZeroExtended, NonNegative).sext(BitWidth);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;ZExtInst&gt;(V)) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// As an optimization, we can clear the SignExtended flag because</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// sext(zext(a)) = zext(a). Verified in @sext_zext in split-gep.ll.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Clear the NonNegative flag, because zext(a) &gt;= 0 does not imply a &gt;= 0.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    ConstantOffset =</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        find(U-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), <span class="comment">/* SignExtended */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;             <span class="comment">/* ZeroExtended */</span> <span class="keyword">true</span>, <span class="comment">/* NonNegative */</span> <span class="keyword">false</span>).zext(BitWidth);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// If we found a non-zero constant offset, add it to the path for</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// rebuildWithoutConstOffset. Zero is a valid constant offset, but doesn&#39;t</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// help this optimization.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (ConstantOffset != 0)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    UserChain.push_back(U);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">return</span> ConstantOffset;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *ConstantOffsetExtractor::applyExts(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Current = V;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// ExtInsts is built in the use-def order. Therefore, we apply them to V</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// in the reversed order.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = ExtInsts.rbegin(), E = ExtInsts.rend(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">C</a> = dyn_cast&lt;Constant&gt;(Current)) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">// If Current is a constant, apply s/zext using ConstantExpr::getCast.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="comment">// ConstantExpr::getCast emits a ConstantInt if C is a ConstantInt.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      Current = <a class="code" href="classllvm_1_1ConstantExpr.html#a49b69843927f7cd96d866768b3aec92b">ConstantExpr::getCast</a>((*I)-&gt;getOpcode(), <a class="code" href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">C</a>, (*I)-&gt;getType());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a88a797f57846adb2c382b3732b471913">Ext</a> = (*I)-&gt;clone();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      Ext-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, Current);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      Ext-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(IP);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      Current = <a class="code" href="namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a88a797f57846adb2c382b3732b471913">Ext</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">return</span> Current;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *ConstantOffsetExtractor::rebuildWithoutConstOffset() {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  distributeExtsAndCloneChain(UserChain.size() - 1);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// Remove all nullptrs (used to be s/zext) from UserChain.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">unsigned</span> NewSize = 0;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = UserChain.begin(), E = UserChain.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      UserChain[NewSize] = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      NewSize++;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  UserChain.resize(NewSize);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">return</span> removeConstOffset(UserChain.size() - 1);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;ConstantOffsetExtractor::distributeExtsAndCloneChain(<span class="keywordtype">unsigned</span> ChainIndex) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <a class="code" href="classllvm_1_1User.html">User</a> *U = UserChain[ChainIndex];</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (ChainIndex == 0) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(isa&lt;ConstantInt&gt;(U));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// If U is a ConstantInt, applyExts will return a ConstantInt as well.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span> UserChain[ChainIndex] = cast&lt;ConstantInt&gt;(applyExts(U));</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *Cast = dyn_cast&lt;CastInst&gt;(U)) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>((isa&lt;SExtInst&gt;(Cast) || isa&lt;ZExtInst&gt;(Cast)) &amp;&amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;           <span class="stringliteral">&quot;We only traced into two types of CastInst: sext and zext&quot;</span>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    ExtInsts.push_back(Cast);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    UserChain[ChainIndex] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">return</span> distributeExtsAndCloneChain(ChainIndex - 1);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// Function find only trace into BinaryOperator and CastInst.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = cast&lt;BinaryOperator&gt;(U);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// OpNo = which operand of BO is UserChain[ChainIndex - 1]</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordtype">unsigned</span> OpNo = (BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == UserChain[ChainIndex - 1] ? 0 : 1);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TheOther = applyExts(BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1 - OpNo));</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NextInChain = distributeExtsAndCloneChain(ChainIndex - 1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *NewBO = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (OpNo == 0) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    NewBO = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(), NextInChain, TheOther,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                   BO-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), IP);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    NewBO = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>(), TheOther, NextInChain,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                   BO-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), IP);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">return</span> UserChain[ChainIndex] = NewBO;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *ConstantOffsetExtractor::removeConstOffset(<span class="keywordtype">unsigned</span> ChainIndex) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">if</span> (ChainIndex == 0) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(isa&lt;ConstantInt&gt;(UserChain[ChainIndex]));</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(UserChain[ChainIndex]-&gt;<a class="code" href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">getType</a>());</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BO = cast&lt;BinaryOperator&gt;(UserChain[ChainIndex]);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordtype">unsigned</span> OpNo = (BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0) == UserChain[ChainIndex - 1] ? 0 : 1);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(OpNo) == UserChain[ChainIndex - 1]);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NextInChain = removeConstOffset(ChainIndex - 1);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TheOther = BO-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(1 - OpNo);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// If NextInChain is 0 and not the LHS of a sub, we can simplify the</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// sub-expression to be just TheOther.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(NextInChain)) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">if</span> (CI-&gt;isZero() &amp;&amp; !(BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2">Instruction::Sub</a> &amp;&amp; OpNo == 0))</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">return</span> TheOther;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">getOpcode</a>() == <a class="code" href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">Instruction::Or</a>) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// Rebuild &quot;or&quot; as &quot;add&quot;, because &quot;or&quot; may be invalid for the new</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// epxression.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// For instance, given</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">//   a | (b + 5) where a and b + 5 have no common bits,</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// we can extract 5 as the constant offset.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// However, reusing the &quot;or&quot; in the new index would give us</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">//   (a | b) + 5</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// which does not equal a | (b + 5).</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">// Replacing the &quot;or&quot; with &quot;add&quot; is fine, because</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">//   a | (b + 5) = a + (b + 5) = (a + b) + 5</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (OpNo == 0) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Reassociate_8cpp.html#a680ae08c1b9b93cebdd6cbb726fe8f3d">BinaryOperator::CreateAdd</a>(NextInChain, TheOther, BO-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(),</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                       IP);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="Reassociate_8cpp.html#a680ae08c1b9b93cebdd6cbb726fe8f3d">BinaryOperator::CreateAdd</a>(TheOther, NextInChain, BO-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                       IP);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// We can reuse BO in this case, because the new expression shares the same</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// instruction type and BO is used at most once.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(BO-&gt;<a class="code" href="classllvm_1_1Value.html#a380559e99b47632a34f74de7c1d03cc0">getNumUses</a>() &lt;= 1 &amp;&amp;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         <span class="stringliteral">&quot;distributeExtsAndCloneChain clones each BinaryOperator in &quot;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         <span class="stringliteral">&quot;UserChain, so no one should be used more than &quot;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;         <span class="stringliteral">&quot;once&quot;</span>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(OpNo, NextInChain);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a21ce697328893029ae2c63974061a294">setHasNoSignedWrap</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#aaa9083a85e23c9c5ee366920d90ae51e">setHasNoUnsignedWrap</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// Make sure it appears after all instructions we&#39;ve inserted so far.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  BO-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(IP);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">return</span> BO;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *ConstantOffsetExtractor::Extract(<a class="code" href="classllvm_1_1Value.html">Value</a> *Idx, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *<a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                        <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  ConstantOffsetExtractor Extractor(DL, GEP);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// Find a non-zero constant offset first.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> ConstantOffset =</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      Extractor.find(Idx, <span class="comment">/* SignExtended */</span> <span class="keyword">false</span>, <span class="comment">/* ZeroExtended */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                     GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#aa87e8100bba232cc73678f86231d7e58">isInBounds</a>());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">if</span> (ConstantOffset == 0)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// Separates the constant offset from the GEP index.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">return</span> Extractor.rebuildWithoutConstOffset();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;int64_t <a class="code" href="SubtargetFeature_8cpp.html#a8fcfa092cd65f49abe6b6dd7c9ae11fe">ConstantOffsetExtractor::Find</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Idx, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> *DL,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// If Idx is an index of an inbound GEP, Idx is guaranteed to be non-negative.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">return</span> ConstantOffsetExtractor(DL, GEP)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      .find(Idx, <span class="comment">/* SignExtended */</span> <span class="keyword">false</span>, <span class="comment">/* ZeroExtended */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#aa87e8100bba232cc73678f86231d7e58">isInBounds</a>())</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      .getSExtValue();</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordtype">void</span> ConstantOffsetExtractor::ComputeKnownBits(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;KnownOne,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                               <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;KnownZero)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *<a class="code" href="ARMSubtarget_8cpp.html#a95aeac94ad0c4396a86dc1351a7fa7eb">IT</a> = cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>());</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  KnownOne = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(IT-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a6f603ab84f6f7c79985036f58cca9d48">getBitWidth</a>(), 0);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  KnownZero = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(IT-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a6f603ab84f6f7c79985036f58cca9d48">getBitWidth</a>(), 0);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <a class="code" href="namespacellvm.html#ae658d371e8e82ac4badd19dde6c6d68d">llvm::computeKnownBits</a>(V, KnownZero, KnownOne, DL, 0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordtype">bool</span> ConstantOffsetExtractor::NoCommonBits(<a class="code" href="classllvm_1_1Value.html">Value</a> *LHS, <a class="code" href="classllvm_1_1Value.html">Value</a> *RHS)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a>(LHS-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() == RHS-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() &amp;&amp;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;         <span class="stringliteral">&quot;LHS and RHS should have the same type&quot;</span>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LHSKnownOne, LHSKnownZero, RHSKnownOne, RHSKnownZero;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  ComputeKnownBits(LHS, LHSKnownOne, LHSKnownZero);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  ComputeKnownBits(RHS, RHSKnownOne, RHSKnownZero);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">return</span> (LHSKnownZero | RHSKnownZero).isAllOnesValue();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keywordtype">bool</span> SeparateConstOffsetFromGEP::canonicalizeArrayIndicesToPointerSize(</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtrTy = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(*GEP);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">User::op_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = GEP-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>() + 1, E = GEP-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ++GTI) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// Skip struct member indices which must be i32.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SequentialType&gt;(*GTI)) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">if</span> ((*I)-&gt;getType() != IntPtrTy) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="classllvm_1_1CastInst.html#a277c32f1a2c680c0af45cbf0ff67c409">CastInst::CreateIntegerCast</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, IntPtrTy, <span class="keyword">true</span>, <span class="stringliteral">&quot;idxprom&quot;</span>, GEP);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;int64_t</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;SeparateConstOffsetFromGEP::accumulateByteOffset(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                 <span class="keywordtype">bool</span> &amp;NeedsExtraction) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  NeedsExtraction = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  int64_t AccumulativeByteOffset = 0;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(*GEP);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, E = GEP-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ++GTI) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SequentialType&gt;(*GTI)) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="comment">// Tries to extract a constant offset from this GEP index.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      int64_t ConstantOffset =</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          <a class="code" href="SubtargetFeature_8cpp.html#a8fcfa092cd65f49abe6b6dd7c9ae11fe">ConstantOffsetExtractor::Find</a>(GEP-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>, GEP);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">if</span> (ConstantOffset != 0) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        NeedsExtraction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">// A GEP may have multiple indices.  We accumulate the extracted</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">// constant offset to a byte offset, and later offset the remainder of</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">// the original GEP with this byte offset.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        AccumulativeByteOffset +=</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            ConstantOffset * DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(GTI.<a class="code" href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">getIndexedType</a>());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LowerGEP) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <a class="code" href="classllvm_1_1StructType.html">StructType</a> *StTy = cast&lt;StructType&gt;(*GTI);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      uint64_t <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a746bc3776b8e263c46912952f7e3d544">Field</a> = cast&lt;ConstantInt&gt;(GEP-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))-&gt;getZExtValue();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">// Skip field 0 as the offset is always 0.</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="keywordflow">if</span> (Field != 0) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        NeedsExtraction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        AccumulativeByteOffset +=</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a35c840104f32575e0d91422cf1ef3ce4">getStructLayout</a>(StTy)-&gt;<a class="code" href="classllvm_1_1StructLayout.html#ae10c4483372a357a0d3411b3d64be10c">getElementOffset</a>(Field);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">return</span> AccumulativeByteOffset;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;}</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordtype">void</span> SeparateConstOffsetFromGEP::lowerToSingleIndexGEPs(</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="namespacellvm_1_1MCID.html#a5eb9635f629c61db37d13202cde65881a06448010e7faa3713221a1b768380957">Variadic</a>, int64_t AccumulativeByteOffset) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(Variadic);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtrTy = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *I8PtrTy =</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      Builder.<a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">getInt8PtrTy</a>(Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ResultPtr = Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (ResultPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != I8PtrTy)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    ResultPtr = Builder.CreateBitCast(ResultPtr, I8PtrTy);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(*Variadic);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// Create an ugly GEP for each sequential index. We don&#39;t create GEPs for</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// structure indices, as they are accumulated in the constant offset index.</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, E = Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ++GTI) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SequentialType&gt;(*GTI)) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx = Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="comment">// Skip zero indices.</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(Idx))</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span> (CI-&gt;isZero())</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> ElementSize = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(IntPtrTy-&gt;<a class="code" href="classllvm_1_1Type.html#a0519dc6e2f153aaed61eed17d965a9f0">getIntegerBitWidth</a>(),</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(GTI.<a class="code" href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">getIndexedType</a>()));</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="comment">// Scale the index by element size.</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span> (ElementSize != 1) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (ElementSize.<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>()) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          Idx = Builder.CreateShl(</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;              Idx, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, ElementSize.<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>()));</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          Idx = Builder.CreateMul(Idx, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, ElementSize));</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="comment">// Create an ugly GEP with a single index for each index.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      ResultPtr = Builder.CreateGEP(ResultPtr, Idx, <span class="stringliteral">&quot;uglygep&quot;</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// Create a GEP with the constant offset index.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span> (AccumulativeByteOffset != 0) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Offset = <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, AccumulativeByteOffset);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    ResultPtr = Builder.CreateGEP(ResultPtr, Offset, <span class="stringliteral">&quot;uglygep&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">if</span> (ResultPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">getType</a>() != Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>())</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    ResultPtr = Builder.CreateBitCast(ResultPtr, Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  Variadic-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(ResultPtr);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  Variadic-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;SeparateConstOffsetFromGEP::lowerToArithmetics(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *Variadic,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                               int64_t AccumulativeByteOffset) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> Builder(Variadic);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtrTy = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ResultPtr = Builder.CreatePtrToInt(Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(0), IntPtrTy);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(*Variadic);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// Create ADD/SHL/MUL arithmetic operations for each sequential indices. We</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// don&#39;t create arithmetics for structure indices, as they are accumulated</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// in the constant offset index.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, E = Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ++GTI) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SequentialType&gt;(*GTI)) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Idx = Variadic-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">// Skip zero indices.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(Idx))</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (CI-&gt;isZero())</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> ElementSize = <a class="code" href="classllvm_1_1APInt.html">APInt</a>(IntPtrTy-&gt;<a class="code" href="classllvm_1_1Type.html#a0519dc6e2f153aaed61eed17d965a9f0">getIntegerBitWidth</a>(),</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(GTI.<a class="code" href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">getIndexedType</a>()));</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// Scale the index by element size.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> (ElementSize != 1) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">if</span> (ElementSize.<a class="code" href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">isPowerOf2</a>()) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          Idx = Builder.CreateShl(</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;              Idx, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, ElementSize.<a class="code" href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">logBase2</a>()));</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;          Idx = Builder.CreateMul(Idx, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, ElementSize));</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">// Create an ADD for each index.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      ResultPtr = Builder.CreateAdd(ResultPtr, Idx);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// Create an ADD for the constant offset index.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (AccumulativeByteOffset != 0) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    ResultPtr = Builder.CreateAdd(</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        ResultPtr, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, AccumulativeByteOffset));</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  ResultPtr = Builder.CreateIntToPtr(ResultPtr, Variadic-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  Variadic-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(ResultPtr);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  Variadic-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordtype">bool</span> SeparateConstOffsetFromGEP::splitGEP(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// Skip vector GEPs.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">isVectorTy</a>())</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// The backend can already nicely handle the case where all indices are</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// constant.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">if</span> (GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a933a0843a97a4ef41022634d9a557de9">hasAllConstantIndices</a>())</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordtype">bool</span> Changed = canonicalizeArrayIndicesToPointerSize(GEP);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">bool</span> NeedsExtraction;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  int64_t AccumulativeByteOffset = accumulateByteOffset(GEP, NeedsExtraction);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (!NeedsExtraction)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// If LowerGEP is disabled, before really splitting the GEP, check whether the</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// backend supports the addressing mode we are about to produce. If no, this</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// splitting probably won&#39;t be beneficial.</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// If LowerGEP is enabled, even the extracted constant offset can not match</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// the addressing mode, we can still do optimizations to other lowered parts</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// of variable indices. Therefore, we don&#39;t check for addressing modes in that</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// case.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (!LowerGEP) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;TTI = getAnalysis&lt;TargetTransformInfo&gt;();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">if</span> (!TTI.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a6b125b01caa4a2ad5c9b621d6540f568">isLegalAddressingMode</a>(GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>()-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>(),</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                   <span class="comment">/*BaseGV=*/</span><span class="keyword">nullptr</span>, AccumulativeByteOffset,</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                   <span class="comment">/*HasBaseReg=*/</span><span class="keyword">true</span>, <span class="comment">/*Scale=*/</span>0)) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// Remove the constant offset in each sequential index. The resultant GEP</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">// computes the variadic base.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">// Notice that we don&#39;t remove struct field indices here. If LowerGEP is</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="comment">// disabled, a structure index is not accumulated and we still use the old</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// one. If LowerGEP is enabled, a structure index is accumulated in the</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// constant offset. LowerToSingleIndexGEPs or lowerToArithmetics will later</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// handle the constant offset and won&#39;t need a new structure index.</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(*GEP);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, E = GEP-&gt;<a class="code" href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">getNumOperands</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != E; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ++GTI) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SequentialType&gt;(*GTI)) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="comment">// Splits this GEP index into a variadic part and a constant offset, and</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="comment">// uses the variadic part as the new index.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewIdx =</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          ConstantOffsetExtractor::Extract(GEP-&gt;<a class="code" href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a>, GEP);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">if</span> (NewIdx != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        GEP-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, NewIdx);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// Clear the inbounds attribute because the new index may be off-bound.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// e.g.,</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">// b = add i64 a, 5</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">// addr = gep inbounds float* p, i64 b</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// is transformed to:</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// addr2 = gep float* p, i64 a</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// addr = gep float* addr2, i64 5</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// If a is -4, although the old index b is in bounds, the new index a is</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">// off-bound. http://llvm.org/docs/LangRef.html#id181 says &quot;if the</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// inbounds keyword is not present, the offsets are added to the base</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">// address with silently-wrapping two&#39;s complement arithmetic&quot;.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// Therefore, the final code will be a semantically equivalent.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment">// TODO(jingyue): do some range analysis to keep as many inbounds as</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// possible. GEPs with inbounds are more friendly to alias analysis.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">setIsInBounds</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// Lowers a GEP to either GEPs with a single index or arithmetic operations.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">if</span> (LowerGEP) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// As currently BasicAA does not analyze ptrtoint/inttoptr, do not lower to</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// arithmetic operations if the target uses alias analysis in codegen.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a> &amp;&amp; <a class="code" href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">TM</a>-&gt;getSubtarget&lt;<a class="code" href="classllvm_1_1TargetSubtargetInfo.html">TargetSubtargetInfo</a>&gt;().<a class="code" href="classllvm_1_1TargetSubtargetInfo.html#a3721bce67edc8213e2856f4ba18b8788">useAA</a>())</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      lowerToSingleIndexGEPs(GEP, AccumulativeByteOffset);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      lowerToArithmetics(GEP, AccumulativeByteOffset);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// No need to create another GEP if the accumulative byte offset is 0.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> (AccumulativeByteOffset == 0)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">// Offsets the base with the accumulative byte offset.</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">//   %gep                        ; the base</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">//   ... %gep ...</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// =&gt; add the offset</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">//   %gep2                       ; clone of %gep</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">//   %new.gep = gep %gep2, &lt;offset / sizeof(*%gep)&gt;</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">//   %gep                        ; will be removed</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">//   ... %gep ...</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">// =&gt; replace all uses of %gep with %new.gep and remove %gep</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">//   %gep2                       ; clone of %gep</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">//   %new.gep = gep %gep2, &lt;offset / sizeof(*%gep)&gt;</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">//   ... %new.gep ...</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">// If AccumulativeByteOffset is not a multiple of sizeof(*%gep), we emit an</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">// uglygep (http://llvm.org/docs/GetElementPtr.html#what-s-an-uglygep):</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">// bitcast %gep2 to i8*, add the offset, and bitcast the result back to the</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// type of %gep.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">//   %gep2                       ; clone of %gep</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">//   %0       = bitcast %gep2 to i8*</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">//   %uglygep = gep %0, &lt;offset&gt;</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">//   %new.gep = bitcast %uglygep to &lt;type of %gep&gt;</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">//   ... %new.gep ...</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewGEP = GEP-&gt;<a class="code" href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">clone</a>();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  NewGEP-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(GEP);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// Per ANSI C standard, signed / unsigned = unsigned and signed % unsigned =</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">// unsigned.. Therefore, we cast ElementTypeSizeOfGEP to signed because it is</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">// used with unsigned integers later.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  int64_t ElementTypeSizeOfGEP = <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">getTypeAllocSize</a>(GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>()-&gt;<a class="code" href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">getElementType</a>()));</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntPtrTy = DL-&gt;<a class="code" href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">getIntPtrType</a>(GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>());</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span> (AccumulativeByteOffset % ElementTypeSizeOfGEP == 0) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// Very likely. As long as %gep is natually aligned, the byte offset we</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// extracted should be a multiple of sizeof(*%gep).</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    int64_t Index = AccumulativeByteOffset / ElementTypeSizeOfGEP;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    NewGEP = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a16dfb78ad49dbc35747e10d720da9481">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        NewGEP, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, Index, <span class="keyword">true</span>), GEP-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), GEP);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">// Unlikely but possible. For example,</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">// #pragma pack(1)</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// struct S {</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">//   int a[3];</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">//   int64 b[8];</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// };</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// #pragma pack()</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// Suppose the gep before extraction is &amp;s[i + 1].b[j + 3]. After</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// extraction, it becomes &amp;s[i].b[j] and AccumulativeByteOffset is</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// sizeof(S) + 3 * sizeof(int64) = 100, which is not a multiple of</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">// sizeof(int64).</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// Emit an uglygep in this case.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *I8PtrTy = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(GEP-&gt;<a class="code" href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">getContext</a>(),</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                       GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a7a3407da7842ed0cff1dc06fd59d6d54">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    NewGEP = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(NewGEP, I8PtrTy, <span class="stringliteral">&quot;&quot;</span>, GEP);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    NewGEP = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a16dfb78ad49dbc35747e10d720da9481">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        NewGEP, <a class="code" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(IntPtrTy, AccumulativeByteOffset, <span class="keyword">true</span>),</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="stringliteral">&quot;uglygep&quot;</span>, GEP);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>() != I8PtrTy)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      NewGEP = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(NewGEP, GEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">getType</a>(), GEP-&gt;<a class="code" href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">getName</a>(), GEP);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  GEP-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewGEP);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  GEP-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">eraseFromParent</a>();</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;}</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="keywordtype">bool</span> SeparateConstOffsetFromGEP::runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a>) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SeparateConstOffsetFromGEP_8cpp.html#a60bf5a3fac0ddb0ce045a4f4cbf90def">DisableSeparateConstOffsetFromGEP</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">Function::iterator</a> B = F.<a class="code" href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">begin</a>(), BE = F.<a class="code" href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">end</a>(); B != BE; ++B) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ilist__iterator.html">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = B-&gt;begin(), <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a> = B-&gt;end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>; ) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GEP = dyn_cast&lt;GetElementPtrInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++)) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        Changed |= splitGEP(GEP);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="comment">// No need to split GEP ConstantExprs because all its indices are constant</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="comment">// already.</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
<div class="ttc" id="TargetSubtargetInfo_8h_html"><div class="ttname"><a href="TargetSubtargetInfo_8h.html">TargetSubtargetInfo.h</a></div></div>
<div class="ttc" id="SeparateConstOffsetFromGEP_8cpp_html_ad564a5d5b29208c8c75ad21a23404191"><div class="ttname"><a href="SeparateConstOffsetFromGEP_8cpp.html#ad564a5d5b29208c8c75ad21a23404191">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(SeparateConstOffsetFromGEP,&quot;separate-const-offset-from-gep&quot;,&quot;Split GEPs to a variadic base and a constant offset for better CSE&quot;, false, false) INITIALIZE_PASS_END(SeparateConstOffsetFromGEP</div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it. ...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00099">DataLayout.h:99</a></div></div>
<div class="ttc" id="classllvm_1_1generic__gep__type__iterator_html_aa9576aea404b156a949122affc839777"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html#aa9576aea404b156a949122affc839777">llvm::generic_gep_type_iterator::getIndexedType</a></div><div class="ttdeci">Type * getIndexedType() const </div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00057">GetElementPtrTypeIterator.h:57</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a21ce697328893029ae2c63974061a294"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a21ce697328893029ae2c63974061a294">llvm::BinaryOperator::setHasNoSignedWrap</a></div><div class="ttdeci">void setHasNoSignedWrap(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02011">Instructions.cpp:2011</a></div></div>
<div class="ttc" id="classllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00031">PassRegistry.cpp:31</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a6fe2f06b8a4b2c3d6308afb223a0238a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00065">Instruction.cpp:65</a></div></div>
<div class="ttc" id="Instructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="classllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">The main container class for the LLVM Intermediate Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00114">Module.h:114</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_ae4ca2261b8b901e415fda7feac5051ea"><div class="ttname"><a href="classllvm_1_1Function.html#ae4ca2261b8b901e415fda7feac5051ea">llvm::Function::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00410">Function.h:410</a></div></div>
<div class="ttc" id="namespacellvm_1_1MipsISD_html_a7a7035feda1dc16252a7a15a7e230122a88a797f57846adb2c382b3732b471913"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a7a7035feda1dc16252a7a15a7e230122a88a797f57846adb2c382b3732b471913">llvm::MipsISD::Ext</a></div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00103">MipsISelLowering.h:103</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2f81e0c1fc6554df7ad2eafabf5fc5a5"><div class="ttname"><a href="classllvm_1_1User.html#a2f81e0c1fc6554df7ad2eafabf5fc5a5">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00109">User.h:109</a></div></div>
<div class="ttc" id="namespacellvm_1_1SystemZISD_html_a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510"><div class="ttname"><a href="namespacellvm_1_1SystemZISD.html#a29ad505e2bf93b191f444dd92702fd48a68ace50a32835aa0562cf8f9694ba510">llvm::SystemZISD::TM</a></div><div class="ttdef"><b>Definition:</b> <a href="SystemZISelLowering_8h_source.html#l00063">SystemZISelLowering.h:63</a></div></div>
<div class="ttc" id="DataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_a7a3407da7842ed0cff1dc06fd59d6d54"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a7a3407da7842ed0cff1dc06fd59d6d54">llvm::GetElementPtrInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Returns the address space of the pointer operand. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00887">Instructions.h:887</a></div></div>
<div class="ttc" id="Target_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="LLParser_8cpp_html_a33ece1ef8074506a15d7f86eb76dbae6"><div class="ttname"><a href="LLParser_8cpp.html#a33ece1ef8074506a15d7f86eb76dbae6">F</a></div><div class="ttdeci">F(f)</div></div>
<div class="ttc" id="classllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00071">Function.h:71</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html_a6f603ab84f6f7c79985036f58cca9d48"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a6f603ab84f6f7c79985036f58cca9d48">llvm::IntegerType::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const </div><div class="ttdoc">Get the number of bits in this IntegerType. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00061">DerivedTypes.h:61</a></div></div>
<div class="ttc" id="namespacellvm_1_1Intrinsic_html_ac015f68d60ea67a2e31bc10bc720d3e8"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#ac015f68d60ea67a2e31bc10bc720d3e8">llvm::Intrinsic::getType</a></div><div class="ttdeci">FunctionType * getType(LLVMContext &amp;Context, ID id, ArrayRef&lt; Type * &gt; Tys=None)</div><div class="ttdoc">Return the function type for an intrinsic. </div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00786">Function.cpp:786</a></div></div>
<div class="ttc" id="classllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00035">User.h:35</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a33f9fa1a7cb21319a30836fce847c3c4"><div class="ttname"><a href="classllvm_1_1Type.html#a33f9fa1a7cb21319a30836fce847c3c4">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const </div><div class="ttdoc">Get the address space of this pointer or pointer vector type. </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00216">Type.cpp:216</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00119">User.h:119</a></div></div>
<div class="ttc" id="namespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdef"><b>Definition:</b> <a href="ARMBaseInfo_8h_source.html#l00091">ARMBaseInfo.h:91</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00107">CommandLine.h:107</a></div></div>
<div class="ttc" id="namespacellvm_html_a1f6978055dbb761b380de39070e34bd3"><div class="ttname"><a href="namespacellvm.html#a1f6978055dbb761b380de39070e34bd3">llvm::report_fatal_error</a></div><div class="ttdeci">LLVM_ATTRIBUTE_NORETURN void report_fatal_error(const char *reason, bool gen_crash_diag=true)</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8cpp_source.html#l00061">ErrorHandling.cpp:61</a></div></div>
<div class="ttc" id="classllvm_1_1generic__gep__type__iterator_html"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html">llvm::generic_gep_type_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00023">GetElementPtrTypeIterator.h:23</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00178">Constants.cpp:178</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_ad452febc1ac0b394876e640ec03ffa38"><div class="ttname"><a href="classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const </div><div class="ttdoc">Return a constant reference to the value&#39;s name. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00159">Value.cpp:159</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00055">PassAnalysisSupport.h:55</a></div></div>
<div class="ttc" id="ValueTracking_8cpp_html_a06c14477546c3a0eb4c79ff007ea2375"><div class="ttname"><a href="ValueTracking_8cpp.html#a06c14477546c3a0eb4c79ff007ea2375">getBitWidth</a></div><div class="ttdeci">static unsigned getBitWidth(Type *Ty, const DataLayout *TD)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00044">ValueTracking.cpp:44</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a35c840104f32575e0d91422cf1ef3ce4"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a35c840104f32575e0d91422cf1ef3ce4">llvm::DataLayout::getStructLayout</a></div><div class="ttdeci">const StructLayout * getStructLayout(StructType *Ty) const </div><div class="ttdoc">Returns a StructLayout object, indicating the alignment of the struct, its size, and the offsets of i...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00521">DataLayout.cpp:521</a></div></div>
<div class="ttc" id="ARMSubtarget_8cpp_html_a95aeac94ad0c4396a86dc1351a7fa7eb"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a95aeac94ad0c4396a86dc1351a7fa7eb">IT</a></div><div class="ttdeci">static cl::opt&lt; ITMode &gt; IT(cl::desc(&quot;IT block support&quot;), cl::Hidden, cl::init(DefaultIT), cl::ZeroOrMore, cl::values(clEnumValN(DefaultIT,&quot;arm-default-it&quot;,&quot;Generate IT block based on arch&quot;), clEnumValN(RestrictedIT,&quot;arm-restrict-it&quot;,&quot;Disallow deprecated IT based on ARMv8&quot;), clEnumValN(NoRestrictedIT,&quot;arm-no-restrict-it&quot;,&quot;Allow IT blocks based on ARMv7&quot;), clEnumValEnd))</div></div>
<div class="ttc" id="classllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">Base class of casting instructions. </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00385">InstrTypes.h:385</a></div></div>
<div class="ttc" id="classllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00190">DerivedTypes.h:190</a></div></div>
<div class="ttc" id="classllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users. </div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00069">Use.h:69</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_aaa9083a85e23c9c5ee366920d90ae51e"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#aaa9083a85e23c9c5ee366920d90ae51e">llvm::BinaryOperator::setHasNoUnsignedWrap</a></div><div class="ttdeci">void setHasNoUnsignedWrap(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02007">Instructions.cpp:2007</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_a837e9f272fd070a5f8fc79c07a951106"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">llvm::GetElementPtrInst::setIsInBounds</a></div><div class="ttdeci">void setIsInBounds(bool b=true)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01433">Instructions.cpp:1433</a></div></div>
<div class="ttc" id="PassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00075">PassSupport.h:75</a></div></div>
<div class="ttc" id="SeparateConstOffsetFromGEP_8cpp_html_ac56c14d91bc69a17e4e5936093b3bc05"><div class="ttname"><a href="SeparateConstOffsetFromGEP_8cpp.html#ac56c14d91bc69a17e4e5936093b3bc05">CSE</a></div><div class="ttdeci">separate const offset from Split GEPs to a variadic base and a constant offset for better CSE</div><div class="ttdef"><b>Definition:</b> <a href="SeparateConstOffsetFromGEP_8cpp_source.html#l00390">SeparateConstOffsetFromGEP.cpp:390</a></div></div>
<div class="ttc" id="classllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00493">IRBuilder.h:493</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af6aad0c9ba7b8720130235c9621b55b5"><div class="ttname"><a href="classllvm_1_1Instruction.html#af6aad0c9ba7b8720130235c9621b55b5">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const </div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00532">Instruction.cpp:532</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00033">Instruction.h:33</a></div></div>
<div class="ttc" id="GlobalMerge_8cpp_html_a7f7b8906dab43d37c78e10eafe4c424f"><div class="ttname"><a href="GlobalMerge_8cpp.html#a7f7b8906dab43d37c78e10eafe4c424f">DL</a></div><div class="ttdeci">INITIALIZE_TM_PASS(GlobalMerge,&quot;global-merge&quot;,&quot;Merge global variables&quot;, false, false) bool GlobalMerge const DataLayout * DL</div><div class="ttdef"><b>Definition:</b> <a href="GlobalMerge_8cpp_source.html#l00147">GlobalMerge.cpp:147</a></div></div>
<div class="ttc" id="Operator_8h_html"><div class="ttname"><a href="Operator_8h.html">Operator.h</a></div></div>
<div class="ttc" id="classllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03743">Instructions.h:3743</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00319">Value.cpp:319</a></div></div>
<div class="ttc" id="classllvm_1_1Function_html_a88a5e60837674780a9d812d661897ac5"><div class="ttname"><a href="classllvm_1_1Function.html#a88a5e60837674780a9d812d661897ac5">llvm::Function::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00408">Function.h:408</a></div></div>
<div class="ttc" id="classllvm_1_1SequentialType_html_a39f2c3a62f293faf11ac28b15bc53359"><div class="ttname"><a href="classllvm_1_1SequentialType.html#a39f2c3a62f293faf11ac28b15bc53359">llvm::SequentialType::getElementType</a></div><div class="ttdeci">Type * getElementType() const </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00322">DerivedTypes.h:322</a></div></div>
<div class="ttc" id="Reassociate_8cpp_html_a680ae08c1b9b93cebdd6cbb726fe8f3d"><div class="ttname"><a href="Reassociate_8cpp.html#a680ae08c1b9b93cebdd6cbb726fe8f3d">CreateAdd</a></div><div class="ttdeci">static BinaryOperator * CreateAdd(Value *S1, Value *S2, const Twine &amp;Name, Instruction *InsertBefore, Value *FlagsOp)</div><div class="ttdef"><b>Definition:</b> <a href="Reassociate_8cpp_source.html#l00352">Reassociate.cpp:352</a></div></div>
<div class="ttc" id="namespacellvm_html_a10b98151467b7d7549f2ec334aabaf2d"><div class="ttname"><a href="namespacellvm.html#a10b98151467b7d7549f2ec334aabaf2d">llvm::initializeSeparateConstOffsetFromGEPPass</a></div><div class="ttdeci">void initializeSeparateConstOffsetFromGEPPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_aa87e8100bba232cc73678f86231d7e58"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#aa87e8100bba232cc73678f86231d7e58">llvm::GetElementPtrInst::isInBounds</a></div><div class="ttdeci">bool isInBounds() const </div><div class="ttdoc">isInBounds - Determine whether the GEP has the inbounds flag. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01437">Instructions.cpp:1437</a></div></div>
<div class="ttc" id="classllvm_1_1StructLayout_html_ae10c4483372a357a0d3411b3d64be10c"><div class="ttname"><a href="classllvm_1_1StructLayout.html#ae10c4483372a357a0d3411b3d64be10c">llvm::StructLayout::getElementOffset</a></div><div class="ttdeci">uint64_t getElementOffset(unsigned Idx) const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00483">DataLayout.h:483</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00789">Instructions.h:789</a></div></div>
<div class="ttc" id="CommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00314">CommandLine.h:314</a></div></div>
<div class="ttc" id="GlobalMerge_8cpp_html_a65c1240c404c646dd0e63fdcbf620730"><div class="ttname"><a href="GlobalMerge_8cpp.html#a65c1240c404c646dd0e63fdcbf620730">assert</a></div><div class="ttdeci">assert(Globals.size() &gt; 1)</div></div>
<div class="ttc" id="ForwardControlFlowIntegrity_8cpp_html_aa6d14665c3f65bf28901537cc0fc8d71"><div class="ttname"><a href="ForwardControlFlowIntegrity_8cpp.html#aa6d14665c3f65bf28901537cc0fc8d71">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(JumpInstrTables)</div></div>
<div class="ttc" id="namespacellvm_html_aa60a21f5ff7be725dc1b4d3f850e6d4a"><div class="ttname"><a href="namespacellvm.html#aa60a21f5ff7be725dc1b4d3f850e6d4a">llvm::createSeparateConstOffsetFromGEPPass</a></div><div class="ttdeci">FunctionPass * createSeparateConstOffsetFromGEPPass(const TargetMachine *TM=nullptr, bool LowerGEP=false)</div><div class="ttdef"><b>Definition:</b> <a href="SeparateConstOffsetFromGEP_8cpp_source.html#l00395">SeparateConstOffsetFromGEP.cpp:395</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00071">Instruction.cpp:71</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a6f725580f7834e2ca90762965866dad4"><div class="ttname"><a href="classllvm_1_1Type.html#a6f725580f7834e2ca90762965866dad4">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00226">Type.h:226</a></div></div>
<div class="ttc" id="classllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">LLVM Constant Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="SubtargetFeature_8cpp_html_a8fcfa092cd65f49abe6b6dd7c9ae11fe"><div class="ttname"><a href="SubtargetFeature_8cpp.html#a8fcfa092cd65f49abe6b6dd7c9ae11fe">Find</a></div><div class="ttdeci">static const SubtargetFeatureKV * Find(StringRef S, ArrayRef&lt; SubtargetFeatureKV &gt; A)</div><div class="ttdoc">Find KV in array using binary search. </div><div class="ttdef"><b>Definition:</b> <a href="SubtargetFeature_8cpp_source.html#l00092">SubtargetFeature.cpp:92</a></div></div>
<div class="ttc" id="Constants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="namespacellvm_1_1APIntOps_html_a22f056804d2b9882f74adc905872bc39"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#a22f056804d2b9882f74adc905872bc39">llvm::APIntOps::Or</a></div><div class="ttdeci">APInt Or(const APInt &amp;LHS, const APInt &amp;RHS)</div><div class="ttdoc">Bitwise OR function for APInt. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01883">APInt.h:1883</a></div></div>
<div class="ttc" id="structllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00289">CommandLine.h:289</a></div></div>
<div class="ttc" id="classllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00037">PassAnalysisSupport.h:37</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00121">User.h:121</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayoutPass_html_a2e204d18cc1dd3f4df97bb8e18b2cf67"><div class="ttname"><a href="classllvm_1_1DataLayoutPass.html#a2e204d18cc1dd3f4df97bb8e18b2cf67">llvm::DataLayoutPass::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const </div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00457">DataLayout.h:457</a></div></div>
<div class="ttc" id="SeparateConstOffsetFromGEP_8cpp_html_a60bf5a3fac0ddb0ce045a4f4cbf90def"><div class="ttname"><a href="SeparateConstOffsetFromGEP_8cpp.html#a60bf5a3fac0ddb0ce045a4f4cbf90def">DisableSeparateConstOffsetFromGEP</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableSeparateConstOffsetFromGEP(&quot;disable-separate-const-offset-from-gep&quot;, cl::init(false), cl::desc(&quot;Do not separate the constant offset from a GEP instruction&quot;), cl::Hidden)</div></div>
<div class="ttc" id="DeadMachineInstructionElim_8cpp_html_a315d40774fd009fbbb69237b11f26525"><div class="ttname"><a href="DeadMachineInstructionElim_8cpp.html#a315d40774fd009fbbb69237b11f26525">for</a></div><div class="ttdeci">for(unsigned i=0, e=MI-&gt;getNumOperands();i!=e;++i)</div><div class="ttdef"><b>Definition:</b> <a href="DeadMachineInstructionElim_8cpp_source.html#l00072">DeadMachineInstructionElim.cpp:72</a></div></div>
<div class="ttc" id="classllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00294">Pass.h:294</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a997ff6a1758bf732b9b263fc61011644"><div class="ttname"><a href="classllvm_1_1User.html#a997ff6a1758bf732b9b263fc61011644">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const </div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00089">User.h:89</a></div></div>
<div class="ttc" id="classllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Integer representation type. </div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00037">DerivedTypes.h:37</a></div></div>
<div class="ttc" id="namespacellvm_html_ab2b5ea0044174b25bc0a6811625868caaec211f7c20af43e742bf2570c3cb84f9"><div class="ttname"><a href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caaec211f7c20af43e742bf2570c3cb84f9">llvm::CFIntegrity::Add</a></div></div>
<div class="ttc" id="PassSupport_8h_html_af0564bcdde2dd4400c670ca278c6035f"><div class="ttname"><a href="PassSupport_8h.html#af0564bcdde2dd4400c670ca278c6035f">INITIALIZE_AG_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_AG_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00072">PassSupport.h:72</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_a933a0843a97a4ef41022634d9a557de9"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a933a0843a97a4ef41022634d9a557de9">llvm::GetElementPtrInst::hasAllConstantIndices</a></div><div class="ttdeci">bool hasAllConstantIndices() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01425">Instructions.cpp:1425</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_af85a4828b6b5a8de7fc0a55cc0e5b52f"><div class="ttname"><a href="classllvm_1_1Value.html#af85a4828b6b5a8de7fc0a55cc0e5b52f">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const </div><div class="ttdoc">All values hold a context through their type. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00614">Value.cpp:614</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00282">Type.cpp:282</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a07783e6f39803037259a1ebe376c2b1e"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a07783e6f39803037259a1ebe376c2b1e">llvm::BinaryOperator::hasNoSignedWrap</a></div><div class="ttdeci">bool hasNoSignedWrap() const </div><div class="ttdoc">Determine whether the no signed wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02023">Instructions.cpp:2023</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_af3deb6522c4fe2043fe07af2ec90190c"><div class="ttname"><a href="classllvm_1_1APInt.html#af3deb6522c4fe2043fe07af2ec90190c">llvm::APInt::isPowerOf2</a></div><div class="ttdeci">bool isPowerOf2() const </div><div class="ttdoc">Check if this APInt&#39;s value is a power of two greater than zero. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00389">APInt.h:389</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_a16dfb78ad49dbc35747e10d720da9481"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a16dfb78ad49dbc35747e10d720da9481">llvm::GetElementPtrInst::Create</a></div><div class="ttdeci">static GetElementPtrInst * Create(Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00806">Instructions.h:806</a></div></div>
<div class="ttc" id="ARMAsmParser_8cpp_html_afa41b5544267a2f619f358964a81c0e9"><div class="ttname"><a href="ARMAsmParser_8cpp.html#afa41b5544267a2f619f358964a81c0e9">ID</a></div><div class="ttdeci">const unsigned ID</div><div class="ttdef"><b>Definition:</b> <a href="ARMAsmParser_8cpp_source.html#l09194">ARMAsmParser.cpp:9194</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_ae84bb2408dfffa4e8b5fe2ce0714a3bd"><div class="ttname"><a href="classllvm_1_1DataLayout.html#ae84bb2408dfffa4e8b5fe2ce0714a3bd">llvm::DataLayout::getIntPtrType</a></div><div class="ttdeci">IntegerType * getIntPtrType(LLVMContext &amp;C, unsigned AddressSpace=0) const </div><div class="ttdoc">Returns an integer type with size at least as big as that of a pointer in the given address space...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00726">DataLayout.cpp:726</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a88505baf41407782678a5df1702d2d31"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a88505baf41407782678a5df1702d2d31">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const </div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00319">InstrTypes.h:319</a></div></div>
<div class="ttc" id="classllvm_1_1CastInst_html_a277c32f1a2c680c0af45cbf0ff67c409"><div class="ttname"><a href="classllvm_1_1CastInst.html#a277c32f1a2c680c0af45cbf0ff67c409">llvm::CastInst::CreateIntegerCast</a></div><div class="ttdeci">static CastInst * CreateIntegerCast(Value *S, Type *Ty, bool isSigned, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Create a ZExt, BitCast, or Trunc for int -&gt; int casts. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02570">Instructions.cpp:2570</a></div></div>
<div class="ttc" id="classllvm_1_1ilist__iterator_html"><div class="ttname"><a href="classllvm_1_1ilist__iterator.html">llvm::ilist_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="ilist_8h_source.html#l00050">ilist.h:50</a></div></div>
<div class="ttc" id="classllvm_1_1Type_html_a0519dc6e2f153aaed61eed17d965a9f0"><div class="ttname"><a href="classllvm_1_1Type.html#a0519dc6e2f153aaed61eed17d965a9f0">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00176">Type.cpp:176</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">Class for constant integers. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00047">Constants.h:47</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00040">TargetTransformInfo.h:40</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayout_html_a1d6fcc02e91ba24510aba42660c90e29"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a1d6fcc02e91ba24510aba42660c90e29">llvm::DataLayout::getTypeAllocSize</a></div><div class="ttdeci">uint64_t getTypeAllocSize(Type *Ty) const </div><div class="ttdoc">Returns the offset in bytes between successive objects of the specified type, including alignment pad...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00364">DataLayout.h:364</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html_a474f562a4871689af74b0fd1ae42daa1"><div class="ttname"><a href="classllvm_1_1APInt.html#a474f562a4871689af74b0fd1ae42daa1">llvm::APInt::logBase2</a></div><div class="ttdeci">unsigned logBase2() const </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01509">APInt.h:1509</a></div></div>
<div class="ttc" id="namespacellvm_html_ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2"><div class="ttname"><a href="namespacellvm.html#ab2b5ea0044174b25bc0a6811625868caae80155eceb940c89e2de63ad05868db2">llvm::CFIntegrity::Sub</a></div></div>
<div class="ttc" id="classllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00882">SmallVector.h:882</a></div></div>
<div class="ttc" id="Module_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a0cf3748dba54f931bb1241ae4adc76bc"><div class="ttname"><a href="classllvm_1_1Value.html#a0cf3748dba54f931bb1241ae4adc76bc">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const </div><div class="ttdoc">All values are typed, get the type of this value. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00222">Value.h:222</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00134">InstrTypes.h:134</a></div></div>
<div class="ttc" id="classllvm_1_1GetElementPtrInst_html_abfc8f5fb56fb06e32a26f28ba7ec1c0b"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#abfc8f5fb56fb06e32a26f28ba7ec1c0b">llvm::GetElementPtrInst::getType</a></div><div class="ttdeci">SequentialType * getType() const </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00844">Instructions.h:844</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00571">Constants.cpp:571</a></div></div>
<div class="ttc" id="classllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00093">User.h:93</a></div></div>
<div class="ttc" id="namespacellvm_1_1MCID_html_a5eb9635f629c61db37d13202cde65881a06448010e7faa3713221a1b768380957"><div class="ttname"><a href="namespacellvm_1_1MCID.html#a5eb9635f629c61db37d13202cde65881a06448010e7faa3713221a1b768380957">llvm::MCID::Variadic</a></div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00102">MCInstrDesc.h:102</a></div></div>
<div class="ttc" id="classllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a02ce9966395063ac501ecbc1623deda4"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01844">Instructions.cpp:1844</a></div></div>
<div class="ttc" id="classllvm_1_1ConstantExpr_html_a49b69843927f7cd96d866768b3aec92b"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a49b69843927f7cd96d866768b3aec92b">llvm::ConstantExpr::getCast</a></div><div class="ttdeci">static Constant * getCast(unsigned ops, Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdoc">Convenience function for getting a Cast operation. </div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01564">Constants.cpp:1564</a></div></div>
<div class="ttc" id="namespacellvm_html_a3ef25ef75dac918e4dc006b078c49b3e"><div class="ttname"><a href="namespacellvm.html#a3ef25ef75dac918e4dc006b078c49b3e">llvm::dyn_cast</a></div><div class="ttdeci">LLVM_ATTRIBUTE_UNUSED_RESULT std::enable_if&lt; !is_simple_type&lt; Y &gt;::value, typename cast_retty&lt; X, const Y &gt;::ret_type &gt;::type dyn_cast(const Y &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00285">Casting.h:285</a></div></div>
<div class="ttc" id="classllvm_1_1TargetSubtargetInfo_html"><div class="ttname"><a href="classllvm_1_1TargetSubtargetInfo.html">llvm::TargetSubtargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetSubtargetInfo_8h_source.html#l00044">TargetSubtargetInfo.h:44</a></div></div>
<div class="ttc" id="Transforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="classllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01128">CommandLine.h:1128</a></div></div>
<div class="ttc" id="classllvm_1_1TargetTransformInfo_html_a6b125b01caa4a2ad5c9b621d6540f568"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a6b125b01caa4a2ad5c9b621d6540f568">llvm::TargetTransformInfo::isLegalAddressingMode</a></div><div class="ttdeci">virtual bool isLegalAddressingMode(Type *Ty, GlobalValue *BaseGV, int64_t BaseOffset, bool HasBaseReg, int64_t Scale) const </div><div class="ttdoc">Return true if the addressing mode represented by AM is legal for this target, for a load/store of th...</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00115">TargetTransformInfo.cpp:115</a></div></div>
<div class="ttc" id="MD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00054">MD5.cpp:54</a></div></div>
<div class="ttc" id="ValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="IRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="LLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="SeparateConstOffsetFromGEP_8cpp_html_a589d62ce2ac872ff25beaad782d27235"><div class="ttname"><a href="SeparateConstOffsetFromGEP_8cpp.html#a589d62ce2ac872ff25beaad782d27235">gep</a></div><div class="ttdeci">separate const offset from gep</div><div class="ttdef"><b>Definition:</b> <a href="SeparateConstOffsetFromGEP_8cpp_source.html#l00390">SeparateConstOffsetFromGEP.cpp:390</a></div></div>
<div class="ttc" id="namespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a746bc3776b8e263c46912952f7e3d544"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a746bc3776b8e263c46912952f7e3d544">llvm::tgtok::Field</a></div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00046">TGLexer.h:46</a></div></div>
<div class="ttc" id="AArch64PromoteConstant_8cpp_html_a90f8350fecae261c25be85d38b451bff"><div class="ttname"><a href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></div><div class="ttdeci">aarch64 promote const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64PromoteConstant_8cpp_source.html#l00213">AArch64PromoteConstant.cpp:213</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00068">Value.h:68</a></div></div>
<div class="ttc" id="classllvm_1_1BinaryOperator_html_a5b6cd6c043f54b40899aff62e6e40488"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a5b6cd6c043f54b40899aff62e6e40488">llvm::BinaryOperator::hasNoUnsignedWrap</a></div><div class="ttdeci">bool hasNoUnsignedWrap() const </div><div class="ttdoc">Determine whether the no unsigned wrap flag is set. </div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02019">Instructions.cpp:2019</a></div></div>
<div class="ttc" id="classllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l00084">Instruction.cpp:84</a></div></div>
<div class="ttc" id="classllvm_1_1TargetMachine_html"><div class="ttname"><a href="classllvm_1_1TargetMachine.html">llvm::TargetMachine</a></div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00061">Target/TargetMachine.h:61</a></div></div>
<div class="ttc" id="raw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="TargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="classllvm_1_1Value_html_a380559e99b47632a34f74de7c1d03cc0"><div class="ttname"><a href="classllvm_1_1Value.html#a380559e99b47632a34f74de7c1d03cc0">llvm::Value::getNumUses</a></div><div class="ttdeci">unsigned getNumUses() const </div><div class="ttdoc">This method computes the number of uses of this Value. </div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00133">Value.cpp:133</a></div></div>
<div class="ttc" id="SubtargetFeature_8cpp_html_a7b9259d83f899b40e4a03159c5bbd017"><div class="ttname"><a href="SubtargetFeature_8cpp.html#a7b9259d83f899b40e4a03159c5bbd017">Split</a></div><div class="ttdeci">static void Split(std::vector&lt; std::string &gt; &amp;V, StringRef S)</div><div class="ttdef"><b>Definition:</b> <a href="SubtargetFeature_8cpp_source.html#l00056">SubtargetFeature.cpp:56</a></div></div>
<div class="ttc" id="SeparateConstOffsetFromGEP_8cpp_html_aea3fbd426f5c98c2645e4050c2d8722a"><div class="ttname"><a href="SeparateConstOffsetFromGEP_8cpp.html#aea3fbd426f5c98c2645e4050c2d8722a">false</a></div><div class="ttdeci">separate const offset from Split GEPs to a variadic base and a constant offset for better false</div><div class="ttdef"><b>Definition:</b> <a href="SeparateConstOffsetFromGEP_8cpp_source.html#l00390">SeparateConstOffsetFromGEP.cpp:390</a></div></div>
<div class="ttc" id="namespacellvm_1_1CallingConv_html_a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a543c358964f4cd0315b2354f7d74e829afd841a49aec1539bc88abc8ff9e170fb">llvm::CallingConv::C</a></div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00034">CallingConv.h:34</a></div></div>
<div class="ttc" id="namespacellvm_html_ae658d371e8e82ac4badd19dde6c6d68d"><div class="ttname"><a href="namespacellvm.html#ae658d371e8e82ac4badd19dde6c6d68d">llvm::computeKnownBits</a></div><div class="ttdeci">void computeKnownBits(Value *V, APInt &amp;KnownZero, APInt &amp;KnownOne, const DataLayout *TD=nullptr, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00103">ValueTracking.cpp:103</a></div></div>
<div class="ttc" id="classllvm_1_1DataLayoutPass_html"><div class="ttname"><a href="classllvm_1_1DataLayoutPass.html">llvm::DataLayoutPass</a></div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00449">DataLayout.h:449</a></div></div>
<div class="ttc" id="namespacellvm_html_ac828b9b52935f87659a4adf237f820a3"><div class="ttname"><a href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">llvm::gep_type_begin</a></div><div class="ttdeci">gep_type_iterator gep_type_begin(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00085">GetElementPtrTypeIterator.h:85</a></div></div>
<div class="ttc" id="classllvm_1_1TargetSubtargetInfo_html_a3721bce67edc8213e2856f4ba18b8788"><div class="ttname"><a href="classllvm_1_1TargetSubtargetInfo.html#a3721bce67edc8213e2856f4ba18b8788">llvm::TargetSubtargetInfo::useAA</a></div><div class="ttdeci">virtual bool useAA() const </div><div class="ttdoc">Enable use of alias analysis during code generation (during MI scheduling, DAGCombine, etc.). </div><div class="ttdef"><b>Definition:</b> <a href="TargetSubtargetInfo_8cpp_source.html#l00059">TargetSubtargetInfo.cpp:59</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr>
<p class="footer">
Generated on Tue Dec 8 2015 00:55:38 for <a href="http://llvm.org/">LLVM</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.8.6</a><br>
Copyright &copy; 2003-2014 University of Illinois at Urbana-Champaign.
All Rights Reserved.</p>
<hr>
<!--#include virtual="/attrib.incl" -->
</body>
</html>
